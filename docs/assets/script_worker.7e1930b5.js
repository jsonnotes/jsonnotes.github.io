(function(){"use strict";const s=new Map;let c=1;const a=r=>(...e)=>new Promise((n,o)=>{const t=c++;s.set(t,{resolve:n,reject:o}),self.postMessage({type:"call",id:t,name:r,args:JSON.stringify(e)})}),u=["openrouter","getNote","addNote","callNote"];self.onmessage=async r=>{const e=r.data||{};if(e.type==="response"){const t=s.get(Number(e.id));if(!t)return;s.delete(Number(e.id)),e.error?t.reject(e.error):t.resolve(e.result);return}if(e.type!=="run")return;const{code:n,input:o}=e;try{const i=await new Function("input",...u,`return (async () => {${n}})()`)(o,...u.map(a));self.postMessage({type:"run_result",ok:!0,result:i})}catch(t){self.postMessage({type:"run_result",ok:!1,error:String(t)})}}})();
