(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();const pr=(e,t,r="",n)=>{const s=document.createElement(e);return s.innerText=t,n&&Object.entries(n).forEach(([o,i])=>{o==="parent"&&i.appendChild(s),o==="children"?i.forEach(a=>s.appendChild(a)):o==="eventListeners"?Object.entries(i).forEach(([a,c])=>{s.addEventListener(a,c)}):o==="color"||o==="background"?s.style[o]=i:o==="style"?Object.entries(i).forEach(([a,c])=>{a=a.replace(/([A-Z])/g,"-$1").toLowerCase(),s.style.setProperty(a,c)}):o==="class"?s.classList.add(...i.split(".").filter(a=>a)):o.startsWith("data-")?s.setAttribute(o,i):s[o]=i}),s},fs=(e,...t)=>{let r=[],n={};const s=o=>{if(typeof o=="string")r.push(pr("span",o));else if(typeof o=="number")r.push(pr("span",o.toString()));else if(o instanceof Promise){const i=nt();o.then(a=>{i.innerHTML="",i.appendChild(nt(a))}),r.push(i)}else o instanceof HTMLElement?r.push(o):o instanceof Array?o.forEach(s):n={...n,...o}};for(let o of t)s(o);return pr(e,"","",{...n,children:r})},$e=e=>(...t)=>fs(e,...t),ue=$e("p"),Et=$e("h2"),Rr=$e("h3"),K=$e("div"),hs=$e("pre"),se=$e("button"),tr=$e("a"),Wt=(e,t=null,...r)=>tr(t??e,{href:e,onclick:n=>{n.metaKey||n.ctrlKey||(n.preventDefault(),history.pushState({},"",e),window.dispatchEvent(new PopStateEvent("popstate")))},style:{color:"inherit",textDecoration:"none",border:"1px solid #ccc",padding:"0.1em",borderRadius:"0.25em"}},...r),nt=$e("span"),po=$e("table"),An=$e("tr"),mo=$e("td"),yo=$e("th"),x=(...e)=>({style:Object.assign({},...e)}),ps=(e,t)=>{const r=t.filter(s=>typeof s=="string").join(" "),n=fs(e,...t);return n.value=r,n},Pt=(...e)=>ps("input",e),Mr=(...e)=>ps("textarea",e),xe=(...e)=>{const t=K({style:{background:"var(--background-color)",color:"var(--color)",padding:"1em",paddingBottom:"2em",borderRadius:"1em",zIndex:"2000",overflowY:"scroll"}},...e),r=K({style:{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(166, 166, 166, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"2000"}});return r.appendChild(t),document.body.appendChild(r),r.onclick=()=>{r.remove()},t.onclick=n=>{n.stopPropagation()},r};function go(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var vr={exports:{}},ms={},Ie={},ze={},It={},F={},kt={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(w){if(super(),!e.IDENTIFIER.test(w))throw new Error("CodeGen: name must be a valid identifier");this.str=w}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class n extends t{constructor(w){super(),this._items=typeof w=="string"?[w]:w}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const w=this._items[0];return w===""||w==='""'}get str(){var w;return(w=this._str)!==null&&w!==void 0?w:this._str=this._items.reduce((P,O)=>`${P}${O}`,"")}get names(){var w;return(w=this._names)!==null&&w!==void 0?w:this._names=this._items.reduce((P,O)=>(O instanceof r&&(P[O.str]=(P[O.str]||0)+1),P),{})}}e._Code=n,e.nil=new n("");function s(h,...w){const P=[h[0]];let O=0;for(;O<w.length;)a(P,w[O]),P.push(h[++O]);return new n(P)}e._=s;const o=new n("+");function i(h,...w){const P=[y(h[0])];let O=0;for(;O<w.length;)P.push(o),a(P,w[O]),P.push(o,y(h[++O]));return c(P),new n(P)}e.str=i;function a(h,w){w instanceof n?h.push(...w._items):w instanceof r?h.push(w):h.push(f(w))}e.addCodeArg=a;function c(h){let w=1;for(;w<h.length-1;){if(h[w]===o){const P=u(h[w-1],h[w+1]);if(P!==void 0){h.splice(w-1,3,P);continue}h[w++]="+"}w++}}function u(h,w){if(w==='""')return h;if(h==='""')return w;if(typeof h=="string")return w instanceof r||h[h.length-1]!=='"'?void 0:typeof w!="string"?`${h.slice(0,-1)}${w}"`:w[0]==='"'?h.slice(0,-1)+w.slice(1):void 0;if(typeof w=="string"&&w[0]==='"'&&!(h instanceof r))return`"${h}${w.slice(1)}`}function d(h,w){return w.emptyStr()?h:h.emptyStr()?w:i`${h}${w}`}e.strConcat=d;function f(h){return typeof h=="number"||typeof h=="boolean"||h===null?h:y(Array.isArray(h)?h.join(","):h)}function g(h){return new n(y(h))}e.stringify=g;function y(h){return JSON.stringify(h).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=y;function m(h){return typeof h=="string"&&e.IDENTIFIER.test(h)?new n(`.${h}`):s`[${h}]`}e.getProperty=m;function _(h){if(typeof h=="string"&&e.IDENTIFIER.test(h))return new n(`${h}`);throw new Error(`CodeGen: invalid export name: ${h}, use explicit $id name mapping`)}e.getEsmExportName=_;function $(h){return new n(h.toString())}e.regexpCode=$})(kt);var wr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=kt;class r extends Error{constructor(u){super(`CodeGen: "code" for ${u} not defined`),this.value=u.value}}var n;(function(c){c[c.Started=0]="Started",c[c.Completed=1]="Completed"})(n||(e.UsedValueState=n={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class s{constructor({prefixes:u,parent:d}={}){this._names={},this._prefixes=u,this._parent=d}toName(u){return u instanceof t.Name?u:this.name(u)}name(u){return new t.Name(this._newName(u))}_newName(u){const d=this._names[u]||this._nameGroup(u);return`${u}${d.index++}`}_nameGroup(u){var d,f;if(((f=(d=this._parent)===null||d===void 0?void 0:d._prefixes)===null||f===void 0?void 0:f.has(u))||this._prefixes&&!this._prefixes.has(u))throw new Error(`CodeGen: prefix "${u}" is not allowed in this scope`);return this._names[u]={prefix:u,index:0}}}e.Scope=s;class o extends t.Name{constructor(u,d){super(d),this.prefix=u}setValue(u,{property:d,itemIndex:f}){this.value=u,this.scopePath=(0,t._)`.${new t.Name(d)}[${f}]`}}e.ValueScopeName=o;const i=(0,t._)`\n`;class a extends s{constructor(u){super(u),this._values={},this._scope=u.scope,this.opts={...u,_n:u.lines?i:t.nil}}get(){return this._scope}name(u){return new o(u,this._newName(u))}value(u,d){var f;if(d.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const g=this.toName(u),{prefix:y}=g,m=(f=d.key)!==null&&f!==void 0?f:d.ref;let _=this._values[y];if(_){const w=_.get(m);if(w)return w}else _=this._values[y]=new Map;_.set(m,g);const $=this._scope[y]||(this._scope[y]=[]),h=$.length;return $[h]=d.ref,g.setValue(d,{property:y,itemIndex:h}),g}getValue(u,d){const f=this._values[u];if(!!f)return f.get(d)}scopeRefs(u,d=this._values){return this._reduceValues(d,f=>{if(f.scopePath===void 0)throw new Error(`CodeGen: name "${f}" has no value`);return(0,t._)`${u}${f.scopePath}`})}scopeCode(u=this._values,d,f){return this._reduceValues(u,g=>{if(g.value===void 0)throw new Error(`CodeGen: name "${g}" has no value`);return g.value.code},d,f)}_reduceValues(u,d,f={},g){let y=t.nil;for(const m in u){const _=u[m];if(!_)continue;const $=f[m]=f[m]||new Map;_.forEach(h=>{if($.has(h))return;$.set(h,n.Started);let w=d(h);if(w){const P=this.opts.es5?e.varKinds.var:e.varKinds.const;y=(0,t._)`${y}${P} ${h} = ${w};${this.opts._n}`}else if(w=g?.(h))y=(0,t._)`${y}${w}${this.opts._n}`;else throw new r(h);$.set(h,n.Completed)})}return y}}e.ValueScope=a})(wr);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=kt,r=wr;var n=kt;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}});var s=wr;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class o{optimizeNodes(){return this}optimizeNames(l,p){return this}}class i extends o{constructor(l,p,k){super(),this.varKind=l,this.name=p,this.rhs=k}render({es5:l,_n:p}){const k=l?r.varKinds.var:this.varKind,A=this.rhs===void 0?"":` = ${this.rhs}`;return`${k} ${this.name}${A};`+p}optimizeNames(l,p){if(!!l[this.name.str])return this.rhs&&(this.rhs=ee(this.rhs,l,p)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class a extends o{constructor(l,p,k){super(),this.lhs=l,this.rhs=p,this.sideEffects=k}render({_n:l}){return`${this.lhs} = ${this.rhs};`+l}optimizeNames(l,p){if(!(this.lhs instanceof t.Name&&!l[this.lhs.str]&&!this.sideEffects))return this.rhs=ee(this.rhs,l,p),this}get names(){const l=this.lhs instanceof t.Name?{}:{...this.lhs.names};return X(l,this.rhs)}}class c extends a{constructor(l,p,k,A){super(l,k,A),this.op=p}render({_n:l}){return`${this.lhs} ${this.op}= ${this.rhs};`+l}}class u extends o{constructor(l){super(),this.label=l,this.names={}}render({_n:l}){return`${this.label}:`+l}}class d extends o{constructor(l){super(),this.label=l,this.names={}}render({_n:l}){return`break${this.label?` ${this.label}`:""};`+l}}class f extends o{constructor(l){super(),this.error=l}render({_n:l}){return`throw ${this.error};`+l}get names(){return this.error.names}}class g extends o{constructor(l){super(),this.code=l}render({_n:l}){return`${this.code};`+l}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(l,p){return this.code=ee(this.code,l,p),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class y extends o{constructor(l=[]){super(),this.nodes=l}render(l){return this.nodes.reduce((p,k)=>p+k.render(l),"")}optimizeNodes(){const{nodes:l}=this;let p=l.length;for(;p--;){const k=l[p].optimizeNodes();Array.isArray(k)?l.splice(p,1,...k):k?l[p]=k:l.splice(p,1)}return l.length>0?this:void 0}optimizeNames(l,p){const{nodes:k}=this;let A=k.length;for(;A--;){const L=k[A];L.optimizeNames(l,p)||(me(l,L.names),k.splice(A,1))}return k.length>0?this:void 0}get names(){return this.nodes.reduce((l,p)=>Z(l,p.names),{})}}class m extends y{render(l){return"{"+l._n+super.render(l)+"}"+l._n}}class _ extends y{}class $ extends m{}$.kind="else";class h extends m{constructor(l,p){super(p),this.condition=l}render(l){let p=`if(${this.condition})`+super.render(l);return this.else&&(p+="else "+this.else.render(l)),p}optimizeNodes(){super.optimizeNodes();const l=this.condition;if(l===!0)return this.nodes;let p=this.else;if(p){const k=p.optimizeNodes();p=this.else=Array.isArray(k)?new $(k):k}if(p)return l===!1?p instanceof h?p:p.nodes:this.nodes.length?this:new h(qe(l),p instanceof h?[p]:p.nodes);if(!(l===!1||!this.nodes.length))return this}optimizeNames(l,p){var k;if(this.else=(k=this.else)===null||k===void 0?void 0:k.optimizeNames(l,p),!!(super.optimizeNames(l,p)||this.else))return this.condition=ee(this.condition,l,p),this}get names(){const l=super.names;return X(l,this.condition),this.else&&Z(l,this.else.names),l}}h.kind="if";class w extends m{}w.kind="for";class P extends w{constructor(l){super(),this.iteration=l}render(l){return`for(${this.iteration})`+super.render(l)}optimizeNames(l,p){if(!!super.optimizeNames(l,p))return this.iteration=ee(this.iteration,l,p),this}get names(){return Z(super.names,this.iteration.names)}}class O extends w{constructor(l,p,k,A){super(),this.varKind=l,this.name=p,this.from=k,this.to=A}render(l){const p=l.es5?r.varKinds.var:this.varKind,{name:k,from:A,to:L}=this;return`for(${p} ${k}=${A}; ${k}<${L}; ${k}++)`+super.render(l)}get names(){const l=X(super.names,this.from);return X(l,this.to)}}class I extends w{constructor(l,p,k,A){super(),this.loop=l,this.varKind=p,this.name=k,this.iterable=A}render(l){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(l)}optimizeNames(l,p){if(!!super.optimizeNames(l,p))return this.iterable=ee(this.iterable,l,p),this}get names(){return Z(super.names,this.iterable.names)}}class R extends m{constructor(l,p,k){super(),this.name=l,this.args=p,this.async=k}render(l){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(l)}}R.kind="func";class D extends y{render(l){return"return "+super.render(l)}}D.kind="return";class J extends m{render(l){let p="try"+super.render(l);return this.catch&&(p+=this.catch.render(l)),this.finally&&(p+=this.finally.render(l)),p}optimizeNodes(){var l,p;return super.optimizeNodes(),(l=this.catch)===null||l===void 0||l.optimizeNodes(),(p=this.finally)===null||p===void 0||p.optimizeNodes(),this}optimizeNames(l,p){var k,A;return super.optimizeNames(l,p),(k=this.catch)===null||k===void 0||k.optimizeNames(l,p),(A=this.finally)===null||A===void 0||A.optimizeNames(l,p),this}get names(){const l=super.names;return this.catch&&Z(l,this.catch.names),this.finally&&Z(l,this.finally.names),l}}class G extends m{constructor(l){super(),this.error=l}render(l){return`catch(${this.error})`+super.render(l)}}G.kind="catch";class Q extends m{render(l){return"finally"+super.render(l)}}Q.kind="finally";class re{constructor(l,p={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...p,_n:p.lines?`
`:""},this._extScope=l,this._scope=new r.Scope({parent:l}),this._nodes=[new _]}toString(){return this._root.render(this.opts)}name(l){return this._scope.name(l)}scopeName(l){return this._extScope.name(l)}scopeValue(l,p){const k=this._extScope.value(l,p);return(this._values[k.prefix]||(this._values[k.prefix]=new Set)).add(k),k}getScopeValue(l,p){return this._extScope.getValue(l,p)}scopeRefs(l){return this._extScope.scopeRefs(l,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(l,p,k,A){const L=this._scope.toName(p);return k!==void 0&&A&&(this._constants[L.str]=k),this._leafNode(new i(l,L,k)),L}const(l,p,k){return this._def(r.varKinds.const,l,p,k)}let(l,p,k){return this._def(r.varKinds.let,l,p,k)}var(l,p,k){return this._def(r.varKinds.var,l,p,k)}assign(l,p,k){return this._leafNode(new a(l,p,k))}add(l,p){return this._leafNode(new c(l,e.operators.ADD,p))}code(l){return typeof l=="function"?l():l!==t.nil&&this._leafNode(new g(l)),this}object(...l){const p=["{"];for(const[k,A]of l)p.length>1&&p.push(","),p.push(k),(k!==A||this.opts.es5)&&(p.push(":"),(0,t.addCodeArg)(p,A));return p.push("}"),new t._Code(p)}if(l,p,k){if(this._blockNode(new h(l)),p&&k)this.code(p).else().code(k).endIf();else if(p)this.code(p).endIf();else if(k)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(l){return this._elseNode(new h(l))}else(){return this._elseNode(new $)}endIf(){return this._endBlockNode(h,$)}_for(l,p){return this._blockNode(l),p&&this.code(p).endFor(),this}for(l,p){return this._for(new P(l),p)}forRange(l,p,k,A,L=this.opts.es5?r.varKinds.var:r.varKinds.let){const W=this._scope.toName(l);return this._for(new O(L,W,p,k),()=>A(W))}forOf(l,p,k,A=r.varKinds.const){const L=this._scope.toName(l);if(this.opts.es5){const W=p instanceof t.Name?p:this.var("_arr",p);return this.forRange("_i",0,(0,t._)`${W}.length`,U=>{this.var(L,(0,t._)`${W}[${U}]`),k(L)})}return this._for(new I("of",A,L,p),()=>k(L))}forIn(l,p,k,A=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf(l,(0,t._)`Object.keys(${p})`,k);const L=this._scope.toName(l);return this._for(new I("in",A,L,p),()=>k(L))}endFor(){return this._endBlockNode(w)}label(l){return this._leafNode(new u(l))}break(l){return this._leafNode(new d(l))}return(l){const p=new D;if(this._blockNode(p),this.code(l),p.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(D)}try(l,p,k){if(!p&&!k)throw new Error('CodeGen: "try" without "catch" and "finally"');const A=new J;if(this._blockNode(A),this.code(l),p){const L=this.name("e");this._currNode=A.catch=new G(L),p(L)}return k&&(this._currNode=A.finally=new Q,this.code(k)),this._endBlockNode(G,Q)}throw(l){return this._leafNode(new f(l))}block(l,p){return this._blockStarts.push(this._nodes.length),l&&this.code(l).endBlock(p),this}endBlock(l){const p=this._blockStarts.pop();if(p===void 0)throw new Error("CodeGen: not in self-balancing block");const k=this._nodes.length-p;if(k<0||l!==void 0&&k!==l)throw new Error(`CodeGen: wrong number of nodes: ${k} vs ${l} expected`);return this._nodes.length=p,this}func(l,p=t.nil,k,A){return this._blockNode(new R(l,p,k)),A&&this.code(A).endFunc(),this}endFunc(){return this._endBlockNode(R)}optimize(l=1){for(;l-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(l){return this._currNode.nodes.push(l),this}_blockNode(l){this._currNode.nodes.push(l),this._nodes.push(l)}_endBlockNode(l,p){const k=this._currNode;if(k instanceof l||p&&k instanceof p)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${p?`${l.kind}/${p.kind}`:l.kind}"`)}_elseNode(l){const p=this._currNode;if(!(p instanceof h))throw new Error('CodeGen: "else" without "if"');return this._currNode=p.else=l,this}get _root(){return this._nodes[0]}get _currNode(){const l=this._nodes;return l[l.length-1]}set _currNode(l){const p=this._nodes;p[p.length-1]=l}}e.CodeGen=re;function Z(E,l){for(const p in l)E[p]=(E[p]||0)+(l[p]||0);return E}function X(E,l){return l instanceof t._CodeOrName?Z(E,l.names):E}function ee(E,l,p){if(E instanceof t.Name)return k(E);if(!A(E))return E;return new t._Code(E._items.reduce((L,W)=>(W instanceof t.Name&&(W=k(W)),W instanceof t._Code?L.push(...W._items):L.push(W),L),[]));function k(L){const W=p[L.str];return W===void 0||l[L.str]!==1?L:(delete l[L.str],W)}function A(L){return L instanceof t._Code&&L._items.some(W=>W instanceof t.Name&&l[W.str]===1&&p[W.str]!==void 0)}}function me(E,l){for(const p in l)E[p]=(E[p]||0)-(l[p]||0)}function qe(E){return typeof E=="boolean"||typeof E=="number"||E===null?!E:(0,t._)`!${j(E)}`}e.not=qe;const Be=b(e.operators.AND);function ut(...E){return E.reduce(Be)}e.and=ut;const Qe=b(e.operators.OR);function M(...E){return E.reduce(Qe)}e.or=M;function b(E){return(l,p)=>l===t.nil?p:p===t.nil?l:(0,t._)`${j(l)} ${E} ${j(p)}`}function j(E){return E instanceof t.Name?E:(0,t._)`(${E})`}})(F);var C={};Object.defineProperty(C,"__esModule",{value:!0});C.checkStrictMode=C.getErrorPath=C.Type=C.useFunc=C.setEvaluated=C.evaluatedPropsToName=C.mergeEvaluated=C.eachItem=C.unescapeJsonPointer=C.escapeJsonPointer=C.escapeFragment=C.unescapeFragment=C.schemaRefOrVal=C.schemaHasRulesButRef=C.schemaHasRules=C.checkUnknownRules=C.alwaysValidSchema=C.toHash=void 0;const B=F,$o=kt;function _o(e){const t={};for(const r of e)t[r]=!0;return t}C.toHash=_o;function vo(e,t){return typeof t=="boolean"?t:Object.keys(t).length===0?!0:(ys(e,t),!gs(t,e.self.RULES.all))}C.alwaysValidSchema=vo;function ys(e,t=e.schema){const{opts:r,self:n}=e;if(!r.strictSchema||typeof t=="boolean")return;const s=n.RULES.keywords;for(const o in t)s[o]||vs(e,`unknown keyword: "${o}"`)}C.checkUnknownRules=ys;function gs(e,t){if(typeof e=="boolean")return!e;for(const r in e)if(t[r])return!0;return!1}C.schemaHasRules=gs;function wo(e,t){if(typeof e=="boolean")return!e;for(const r in e)if(r!=="$ref"&&t.all[r])return!0;return!1}C.schemaHasRulesButRef=wo;function bo({topSchemaRef:e,schemaPath:t},r,n,s){if(!s){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,B._)`${r}`}return(0,B._)`${e}${t}${(0,B.getProperty)(n)}`}C.schemaRefOrVal=bo;function So(e){return $s(decodeURIComponent(e))}C.unescapeFragment=So;function Eo(e){return encodeURIComponent(Cr(e))}C.escapeFragment=Eo;function Cr(e){return typeof e=="number"?`${e}`:e.replace(/~/g,"~0").replace(/\//g,"~1")}C.escapeJsonPointer=Cr;function $s(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}C.unescapeJsonPointer=$s;function Po(e,t){if(Array.isArray(e))for(const r of e)t(r);else t(e)}C.eachItem=Po;function Vn({mergeNames:e,mergeToName:t,mergeValues:r,resultToName:n}){return(s,o,i,a)=>{const c=i===void 0?o:i instanceof B.Name?(o instanceof B.Name?e(s,o,i):t(s,o,i),i):o instanceof B.Name?(t(s,i,o),o):r(o,i);return a===B.Name&&!(c instanceof B.Name)?n(s,c):c}}C.mergeEvaluated={props:Vn({mergeNames:(e,t,r)=>e.if((0,B._)`${r} !== true && ${t} !== undefined`,()=>{e.if((0,B._)`${t} === true`,()=>e.assign(r,!0),()=>e.assign(r,(0,B._)`${r} || {}`).code((0,B._)`Object.assign(${r}, ${t})`))}),mergeToName:(e,t,r)=>e.if((0,B._)`${r} !== true`,()=>{t===!0?e.assign(r,!0):(e.assign(r,(0,B._)`${r} || {}`),Dr(e,r,t))}),mergeValues:(e,t)=>e===!0?!0:{...e,...t},resultToName:_s}),items:Vn({mergeNames:(e,t,r)=>e.if((0,B._)`${r} !== true && ${t} !== undefined`,()=>e.assign(r,(0,B._)`${t} === true ? true : ${r} > ${t} ? ${r} : ${t}`)),mergeToName:(e,t,r)=>e.if((0,B._)`${r} !== true`,()=>e.assign(r,t===!0?!0:(0,B._)`${r} > ${t} ? ${r} : ${t}`)),mergeValues:(e,t)=>e===!0?!0:Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})};function _s(e,t){if(t===!0)return e.var("props",!0);const r=e.var("props",(0,B._)`{}`);return t!==void 0&&Dr(e,r,t),r}C.evaluatedPropsToName=_s;function Dr(e,t,r){Object.keys(r).forEach(n=>e.assign((0,B._)`${t}${(0,B.getProperty)(n)}`,!0))}C.setEvaluated=Dr;const Ln={};function ko(e,t){return e.scopeValue("func",{ref:t,code:Ln[t.code]||(Ln[t.code]=new $o._Code(t.code))})}C.useFunc=ko;var br;(function(e){e[e.Num=0]="Num",e[e.Str=1]="Str"})(br||(C.Type=br={}));function No(e,t,r){if(e instanceof B.Name){const n=t===br.Num;return r?n?(0,B._)`"[" + ${e} + "]"`:(0,B._)`"['" + ${e} + "']"`:n?(0,B._)`"/" + ${e}`:(0,B._)`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,B.getProperty)(e).toString():"/"+Cr(e)}C.getErrorPath=No;function vs(e,t,r=e.opts.strictSchema){if(!!r){if(t=`strict mode: ${t}`,r===!0)throw new Error(t);e.self.logger.warn(t)}}C.checkStrictMode=vs;var je={};Object.defineProperty(je,"__esModule",{value:!0});const le=F,Oo={data:new le.Name("data"),valCxt:new le.Name("valCxt"),instancePath:new le.Name("instancePath"),parentData:new le.Name("parentData"),parentDataProperty:new le.Name("parentDataProperty"),rootData:new le.Name("rootData"),dynamicAnchors:new le.Name("dynamicAnchors"),vErrors:new le.Name("vErrors"),errors:new le.Name("errors"),this:new le.Name("this"),self:new le.Name("self"),scope:new le.Name("scope"),json:new le.Name("json"),jsonPos:new le.Name("jsonPos"),jsonLen:new le.Name("jsonLen"),jsonPart:new le.Name("jsonPart")};je.default=Oo;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=F,r=C,n=je;e.keywordError={message:({keyword:$})=>(0,t.str)`must pass "${$}" keyword validation`},e.keyword$DataError={message:({keyword:$,schemaType:h})=>h?(0,t.str)`"${$}" keyword must be ${h} ($data)`:(0,t.str)`"${$}" keyword is invalid ($data)`};function s($,h=e.keywordError,w,P){const{it:O}=$,{gen:I,compositeRule:R,allErrors:D}=O,J=f($,h,w);P??(R||D)?c(I,J):u(O,(0,t._)`[${J}]`)}e.reportError=s;function o($,h=e.keywordError,w){const{it:P}=$,{gen:O,compositeRule:I,allErrors:R}=P,D=f($,h,w);c(O,D),I||R||u(P,n.default.vErrors)}e.reportExtraError=o;function i($,h){$.assign(n.default.errors,h),$.if((0,t._)`${n.default.vErrors} !== null`,()=>$.if(h,()=>$.assign((0,t._)`${n.default.vErrors}.length`,h),()=>$.assign(n.default.vErrors,null)))}e.resetErrorsCount=i;function a({gen:$,keyword:h,schemaValue:w,data:P,errsCount:O,it:I}){if(O===void 0)throw new Error("ajv implementation error");const R=$.name("err");$.forRange("i",O,n.default.errors,D=>{$.const(R,(0,t._)`${n.default.vErrors}[${D}]`),$.if((0,t._)`${R}.instancePath === undefined`,()=>$.assign((0,t._)`${R}.instancePath`,(0,t.strConcat)(n.default.instancePath,I.errorPath))),$.assign((0,t._)`${R}.schemaPath`,(0,t.str)`${I.errSchemaPath}/${h}`),I.opts.verbose&&($.assign((0,t._)`${R}.schema`,w),$.assign((0,t._)`${R}.data`,P))})}e.extendErrors=a;function c($,h){const w=$.const("err",h);$.if((0,t._)`${n.default.vErrors} === null`,()=>$.assign(n.default.vErrors,(0,t._)`[${w}]`),(0,t._)`${n.default.vErrors}.push(${w})`),$.code((0,t._)`${n.default.errors}++`)}function u($,h){const{gen:w,validateName:P,schemaEnv:O}=$;O.$async?w.throw((0,t._)`new ${$.ValidationError}(${h})`):(w.assign((0,t._)`${P}.errors`,h),w.return(!1))}const d={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function f($,h,w){const{createErrors:P}=$.it;return P===!1?(0,t._)`{}`:g($,h,w)}function g($,h,w={}){const{gen:P,it:O}=$,I=[y(O,w),m($,w)];return _($,h,I),P.object(...I)}function y({errorPath:$},{instancePath:h}){const w=h?(0,t.str)`${$}${(0,r.getErrorPath)(h,r.Type.Str)}`:$;return[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,w)]}function m({keyword:$,it:{errSchemaPath:h}},{schemaPath:w,parentSchema:P}){let O=P?h:(0,t.str)`${h}/${$}`;return w&&(O=(0,t.str)`${O}${(0,r.getErrorPath)(w,r.Type.Str)}`),[d.schemaPath,O]}function _($,{params:h,message:w},P){const{keyword:O,data:I,schemaValue:R,it:D}=$,{opts:J,propertyName:G,topSchemaRef:Q,schemaPath:re}=D;P.push([d.keyword,O],[d.params,typeof h=="function"?h($):h||(0,t._)`{}`]),J.messages&&P.push([d.message,typeof w=="function"?w($):w]),J.verbose&&P.push([d.schema,R],[d.parentSchema,(0,t._)`${Q}${re}`],[n.default.data,I]),G&&P.push([d.propertyName,G])}})(It);var qn;function jo(){if(qn)return ze;qn=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.boolOrEmptySchema=ze.topBoolOrEmptySchema=void 0;const e=It,t=F,r=je,n={message:"boolean schema is false"};function s(a){const{gen:c,schema:u,validateName:d}=a;u===!1?i(a,!1):typeof u=="object"&&u.$async===!0?c.return(r.default.data):(c.assign((0,t._)`${d}.errors`,null),c.return(!0))}ze.topBoolOrEmptySchema=s;function o(a,c){const{gen:u,schema:d}=a;d===!1?(u.var(c,!1),i(a)):u.var(c,!0)}ze.boolOrEmptySchema=o;function i(a,c){const{gen:u,data:d}=a,f={gen:u,keyword:"false schema",data:d,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:a};(0,e.reportError)(f,n,void 0,c)}return ze}var ne={},Je={};Object.defineProperty(Je,"__esModule",{value:!0});Je.getRules=Je.isJSONType=void 0;const Io=["string","number","integer","boolean","null","object","array"],To=new Set(Io);function Ro(e){return typeof e=="string"&&To.has(e)}Je.isJSONType=Ro;function Mo(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}Je.getRules=Mo;var Re={};Object.defineProperty(Re,"__esModule",{value:!0});Re.shouldUseRule=Re.shouldUseGroup=Re.schemaHasRulesForType=void 0;function Co({schema:e,self:t},r){const n=t.RULES.types[r];return n&&n!==!0&&ws(e,n)}Re.schemaHasRulesForType=Co;function ws(e,t){return t.rules.some(r=>bs(e,r))}Re.shouldUseGroup=ws;function bs(e,t){var r;return e[t.keyword]!==void 0||((r=t.definition.implements)===null||r===void 0?void 0:r.some(n=>e[n]!==void 0))}Re.shouldUseRule=bs;Object.defineProperty(ne,"__esModule",{value:!0});ne.reportTypeError=ne.checkDataTypes=ne.checkDataType=ne.coerceAndCheckDataType=ne.getJSONTypes=ne.getSchemaTypes=ne.DataType=void 0;const Do=Je,Ao=Re,Vo=It,q=F,Ss=C;var tt;(function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong"})(tt||(ne.DataType=tt={}));function Lo(e){const t=Es(e.type);if(t.includes("null")){if(e.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&e.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');e.nullable===!0&&t.push("null")}return t}ne.getSchemaTypes=Lo;function Es(e){const t=Array.isArray(e)?e:e?[e]:[];if(t.every(Do.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}ne.getJSONTypes=Es;function qo(e,t){const{gen:r,data:n,opts:s}=e,o=zo(t,s.coerceTypes),i=t.length>0&&!(o.length===0&&t.length===1&&(0,Ao.schemaHasRulesForType)(e,t[0]));if(i){const a=Ar(t,n,s.strictNumbers,tt.Wrong);r.if(a,()=>{o.length?Ho(e,t,o):Vr(e)})}return i}ne.coerceAndCheckDataType=qo;const Ps=new Set(["string","number","integer","boolean","null"]);function zo(e,t){return t?e.filter(r=>Ps.has(r)||t==="array"&&r==="array"):[]}function Ho(e,t,r){const{gen:n,data:s,opts:o}=e,i=n.let("dataType",(0,q._)`typeof ${s}`),a=n.let("coerced",(0,q._)`undefined`);o.coerceTypes==="array"&&n.if((0,q._)`${i} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>n.assign(s,(0,q._)`${s}[0]`).assign(i,(0,q._)`typeof ${s}`).if(Ar(t,s,o.strictNumbers),()=>n.assign(a,s))),n.if((0,q._)`${a} !== undefined`);for(const u of r)(Ps.has(u)||u==="array"&&o.coerceTypes==="array")&&c(u);n.else(),Vr(e),n.endIf(),n.if((0,q._)`${a} !== undefined`,()=>{n.assign(s,a),Fo(e,a)});function c(u){switch(u){case"string":n.elseIf((0,q._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,q._)`"" + ${s}`).elseIf((0,q._)`${s} === null`).assign(a,(0,q._)`""`);return;case"number":n.elseIf((0,q._)`${i} == "boolean" || ${s} === null
              || (${i} == "string" && ${s} && ${s} == +${s})`).assign(a,(0,q._)`+${s}`);return;case"integer":n.elseIf((0,q._)`${i} === "boolean" || ${s} === null
              || (${i} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(a,(0,q._)`+${s}`);return;case"boolean":n.elseIf((0,q._)`${s} === "false" || ${s} === 0 || ${s} === null`).assign(a,!1).elseIf((0,q._)`${s} === "true" || ${s} === 1`).assign(a,!0);return;case"null":n.elseIf((0,q._)`${s} === "" || ${s} === 0 || ${s} === false`),n.assign(a,null);return;case"array":n.elseIf((0,q._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${s} === null`).assign(a,(0,q._)`[${s}]`)}}}function Fo({gen:e,parentData:t,parentDataProperty:r},n){e.if((0,q._)`${t} !== undefined`,()=>e.assign((0,q._)`${t}[${r}]`,n))}function Sr(e,t,r,n=tt.Correct){const s=n===tt.Correct?q.operators.EQ:q.operators.NEQ;let o;switch(e){case"null":return(0,q._)`${t} ${s} null`;case"array":o=(0,q._)`Array.isArray(${t})`;break;case"object":o=(0,q._)`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":o=i((0,q._)`!(${t} % 1) && !isNaN(${t})`);break;case"number":o=i();break;default:return(0,q._)`typeof ${t} ${s} ${e}`}return n===tt.Correct?o:(0,q.not)(o);function i(a=q.nil){return(0,q.and)((0,q._)`typeof ${t} == "number"`,a,r?(0,q._)`isFinite(${t})`:q.nil)}}ne.checkDataType=Sr;function Ar(e,t,r,n){if(e.length===1)return Sr(e[0],t,r,n);let s;const o=(0,Ss.toHash)(e);if(o.array&&o.object){const i=(0,q._)`typeof ${t} != "object"`;s=o.null?i:(0,q._)`!${t} || ${i}`,delete o.null,delete o.array,delete o.object}else s=q.nil;o.number&&delete o.integer;for(const i in o)s=(0,q.and)(s,Sr(i,t,r,n));return s}ne.checkDataTypes=Ar;const Ko={message:({schema:e})=>`must be ${e}`,params:({schema:e,schemaValue:t})=>typeof e=="string"?(0,q._)`{type: ${e}}`:(0,q._)`{type: ${t}}`};function Vr(e){const t=Uo(e);(0,Vo.reportError)(t,Ko)}ne.reportTypeError=Vr;function Uo(e){const{gen:t,data:r,schema:n}=e,s=(0,Ss.schemaRefOrVal)(e,n,"type");return{gen:t,keyword:"type",data:r,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:e}}var ft={},zn;function xo(){if(zn)return ft;zn=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.assignDefaults=void 0;const e=F,t=C;function r(s,o){const{properties:i,items:a}=s.schema;if(o==="object"&&i)for(const c in i)n(s,c,i[c].default);else o==="array"&&Array.isArray(a)&&a.forEach((c,u)=>n(s,u,c.default))}ft.assignDefaults=r;function n(s,o,i){const{gen:a,compositeRule:c,data:u,opts:d}=s;if(i===void 0)return;const f=(0,e._)`${u}${(0,e.getProperty)(o)}`;if(c){(0,t.checkStrictMode)(s,`default is ignored for: ${f}`);return}let g=(0,e._)`${f} === undefined`;d.useDefaults==="empty"&&(g=(0,e._)`${g} || ${f} === null || ${f} === ""`),a.if(g,(0,e._)`${f} = ${(0,e.stringify)(i)}`)}return ft}var ve={},H={};Object.defineProperty(H,"__esModule",{value:!0});H.validateUnion=H.validateArray=H.usePattern=H.callValidateCode=H.schemaProperties=H.allSchemaProperties=H.noPropertyInData=H.propertyInData=H.isOwnProperty=H.hasPropFunc=H.reportMissingProp=H.checkMissingProp=H.checkReportMissingProp=void 0;const Y=F,Lr=C,Ce=je,Jo=C;function Go(e,t){const{gen:r,data:n,it:s}=e;r.if(zr(r,n,t,s.opts.ownProperties),()=>{e.setParams({missingProperty:(0,Y._)`${t}`},!0),e.error()})}H.checkReportMissingProp=Go;function Wo({gen:e,data:t,it:{opts:r}},n,s){return(0,Y.or)(...n.map(o=>(0,Y.and)(zr(e,t,o,r.ownProperties),(0,Y._)`${s} = ${o}`)))}H.checkMissingProp=Wo;function Bo(e,t){e.setParams({missingProperty:t},!0),e.error()}H.reportMissingProp=Bo;function ks(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,Y._)`Object.prototype.hasOwnProperty`})}H.hasPropFunc=ks;function qr(e,t,r){return(0,Y._)`${ks(e)}.call(${t}, ${r})`}H.isOwnProperty=qr;function Qo(e,t,r,n){const s=(0,Y._)`${t}${(0,Y.getProperty)(r)} !== undefined`;return n?(0,Y._)`${s} && ${qr(e,t,r)}`:s}H.propertyInData=Qo;function zr(e,t,r,n){const s=(0,Y._)`${t}${(0,Y.getProperty)(r)} === undefined`;return n?(0,Y.or)(s,(0,Y.not)(qr(e,t,r))):s}H.noPropertyInData=zr;function Ns(e){return e?Object.keys(e).filter(t=>t!=="__proto__"):[]}H.allSchemaProperties=Ns;function Xo(e,t){return Ns(t).filter(r=>!(0,Lr.alwaysValidSchema)(e,t[r]))}H.schemaProperties=Xo;function Yo({schemaCode:e,data:t,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:o},it:i},a,c,u){const d=u?(0,Y._)`${e}, ${t}, ${n}${s}`:t,f=[[Ce.default.instancePath,(0,Y.strConcat)(Ce.default.instancePath,o)],[Ce.default.parentData,i.parentData],[Ce.default.parentDataProperty,i.parentDataProperty],[Ce.default.rootData,Ce.default.rootData]];i.opts.dynamicRef&&f.push([Ce.default.dynamicAnchors,Ce.default.dynamicAnchors]);const g=(0,Y._)`${d}, ${r.object(...f)}`;return c!==Y.nil?(0,Y._)`${a}.call(${c}, ${g})`:(0,Y._)`${a}(${g})`}H.callValidateCode=Yo;const Zo=(0,Y._)`new RegExp`;function ea({gen:e,it:{opts:t}},r){const n=t.unicodeRegExp?"u":"",{regExp:s}=t.code,o=s(r,n);return e.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,Y._)`${s.code==="new RegExp"?Zo:(0,Jo.useFunc)(e,s)}(${r}, ${n})`})}H.usePattern=ea;function ta(e){const{gen:t,data:r,keyword:n,it:s}=e,o=t.name("valid");if(s.allErrors){const a=t.let("valid",!0);return i(()=>t.assign(a,!1)),a}return t.var(o,!0),i(()=>t.break()),o;function i(a){const c=t.const("len",(0,Y._)`${r}.length`);t.forRange("i",0,c,u=>{e.subschema({keyword:n,dataProp:u,dataPropType:Lr.Type.Num},o),t.if((0,Y.not)(o),a)})}}H.validateArray=ta;function ra(e){const{gen:t,schema:r,keyword:n,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,Lr.alwaysValidSchema)(s,c))&&!s.opts.unevaluated)return;const i=t.let("valid",!1),a=t.name("_valid");t.block(()=>r.forEach((c,u)=>{const d=e.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);t.assign(i,(0,Y._)`${i} || ${a}`),e.mergeValidEvaluated(d,a)||t.if((0,Y.not)(i))})),e.result(i,()=>e.reset(),()=>e.error(!0))}H.validateUnion=ra;var Hn;function na(){if(Hn)return ve;Hn=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.validateKeywordUsage=ve.validSchemaType=ve.funcKeywordCode=ve.macroKeywordCode=void 0;const e=F,t=je,r=H,n=It;function s(g,y){const{gen:m,keyword:_,schema:$,parentSchema:h,it:w}=g,P=y.macro.call(w.self,$,h,w),O=u(m,_,P);w.opts.validateSchema!==!1&&w.self.validateSchema(P,!0);const I=m.name("valid");g.subschema({schema:P,schemaPath:e.nil,errSchemaPath:`${w.errSchemaPath}/${_}`,topSchemaRef:O,compositeRule:!0},I),g.pass(I,()=>g.error(!0))}ve.macroKeywordCode=s;function o(g,y){var m;const{gen:_,keyword:$,schema:h,parentSchema:w,$data:P,it:O}=g;c(O,y);const I=!P&&y.compile?y.compile.call(O.self,h,w,O):y.validate,R=u(_,$,I),D=_.let("valid");g.block$data(D,J),g.ok((m=y.valid)!==null&&m!==void 0?m:D);function J(){if(y.errors===!1)re(),y.modifying&&i(g),Z(()=>g.error());else{const X=y.async?G():Q();y.modifying&&i(g),Z(()=>a(g,X))}}function G(){const X=_.let("ruleErrs",null);return _.try(()=>re((0,e._)`await `),ee=>_.assign(D,!1).if((0,e._)`${ee} instanceof ${O.ValidationError}`,()=>_.assign(X,(0,e._)`${ee}.errors`),()=>_.throw(ee))),X}function Q(){const X=(0,e._)`${R}.errors`;return _.assign(X,null),re(e.nil),X}function re(X=y.async?(0,e._)`await `:e.nil){const ee=O.opts.passContext?t.default.this:t.default.self,me=!("compile"in y&&!P||y.schema===!1);_.assign(D,(0,e._)`${X}${(0,r.callValidateCode)(g,R,ee,me)}`,y.modifying)}function Z(X){var ee;_.if((0,e.not)((ee=y.valid)!==null&&ee!==void 0?ee:D),X)}}ve.funcKeywordCode=o;function i(g){const{gen:y,data:m,it:_}=g;y.if(_.parentData,()=>y.assign(m,(0,e._)`${_.parentData}[${_.parentDataProperty}]`))}function a(g,y){const{gen:m}=g;m.if((0,e._)`Array.isArray(${y})`,()=>{m.assign(t.default.vErrors,(0,e._)`${t.default.vErrors} === null ? ${y} : ${t.default.vErrors}.concat(${y})`).assign(t.default.errors,(0,e._)`${t.default.vErrors}.length`),(0,n.extendErrors)(g)},()=>g.error())}function c({schemaEnv:g},y){if(y.async&&!g.$async)throw new Error("async keyword in sync schema")}function u(g,y,m){if(m===void 0)throw new Error(`keyword "${y}" failed to compile`);return g.scopeValue("keyword",typeof m=="function"?{ref:m}:{ref:m,code:(0,e.stringify)(m)})}function d(g,y,m=!1){return!y.length||y.some(_=>_==="array"?Array.isArray(g):_==="object"?g&&typeof g=="object"&&!Array.isArray(g):typeof g==_||m&&typeof g>"u")}ve.validSchemaType=d;function f({schema:g,opts:y,self:m,errSchemaPath:_},$,h){if(Array.isArray($.keyword)?!$.keyword.includes(h):$.keyword!==h)throw new Error("ajv implementation error");const w=$.dependencies;if(w?.some(P=>!Object.prototype.hasOwnProperty.call(g,P)))throw new Error(`parent schema must have dependencies of ${h}: ${w.join(",")}`);if($.validateSchema&&!$.validateSchema(g[h])){const O=`keyword "${h}" value is invalid at path "${_}": `+m.errorsText($.validateSchema.errors);if(y.validateSchema==="log")m.logger.error(O);else throw new Error(O)}}return ve.validateKeywordUsage=f,ve}var Te={},Fn;function sa(){if(Fn)return Te;Fn=1,Object.defineProperty(Te,"__esModule",{value:!0}),Te.extendSubschemaMode=Te.extendSubschemaData=Te.getSubschema=void 0;const e=F,t=C;function r(o,{keyword:i,schemaProp:a,schema:c,schemaPath:u,errSchemaPath:d,topSchemaRef:f}){if(i!==void 0&&c!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(i!==void 0){const g=o.schema[i];return a===void 0?{schema:g,schemaPath:(0,e._)`${o.schemaPath}${(0,e.getProperty)(i)}`,errSchemaPath:`${o.errSchemaPath}/${i}`}:{schema:g[a],schemaPath:(0,e._)`${o.schemaPath}${(0,e.getProperty)(i)}${(0,e.getProperty)(a)}`,errSchemaPath:`${o.errSchemaPath}/${i}/${(0,t.escapeFragment)(a)}`}}if(c!==void 0){if(u===void 0||d===void 0||f===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:c,schemaPath:u,topSchemaRef:f,errSchemaPath:d}}throw new Error('either "keyword" or "schema" must be passed')}Te.getSubschema=r;function n(o,i,{dataProp:a,dataPropType:c,data:u,dataTypes:d,propertyName:f}){if(u!==void 0&&a!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:g}=i;if(a!==void 0){const{errorPath:m,dataPathArr:_,opts:$}=i,h=g.let("data",(0,e._)`${i.data}${(0,e.getProperty)(a)}`,!0);y(h),o.errorPath=(0,e.str)`${m}${(0,t.getErrorPath)(a,c,$.jsPropertySyntax)}`,o.parentDataProperty=(0,e._)`${a}`,o.dataPathArr=[..._,o.parentDataProperty]}if(u!==void 0){const m=u instanceof e.Name?u:g.let("data",u,!0);y(m),f!==void 0&&(o.propertyName=f)}d&&(o.dataTypes=d);function y(m){o.data=m,o.dataLevel=i.dataLevel+1,o.dataTypes=[],i.definedProperties=new Set,o.parentData=i.data,o.dataNames=[...i.dataNames,m]}}Te.extendSubschemaData=n;function s(o,{jtdDiscriminator:i,jtdMetadata:a,compositeRule:c,createErrors:u,allErrors:d}){c!==void 0&&(o.compositeRule=c),u!==void 0&&(o.createErrors=u),d!==void 0&&(o.allErrors=d),o.jtdDiscriminator=i,o.jtdMetadata=a}return Te.extendSubschemaMode=s,Te}var ce={},Os=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,s,o;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(o=Object.keys(t),n=o.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=n;s--!==0;){var i=o[s];if(!e(t[i],r[i]))return!1}return!0}return t!==t&&r!==r},js={exports:{}},Ae=js.exports=function(e,t,r){typeof t=="function"&&(r=t,t={}),r=t.cb||r;var n=typeof r=="function"?r:r.pre||function(){},s=r.post||function(){};Ft(t,n,s,e,"",e)};Ae.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Ae.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Ae.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Ae.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Ft(e,t,r,n,s,o,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){t(n,s,o,i,a,c,u);for(var d in n){var f=n[d];if(Array.isArray(f)){if(d in Ae.arrayKeywords)for(var g=0;g<f.length;g++)Ft(e,t,r,f[g],s+"/"+d+"/"+g,o,s,d,n,g)}else if(d in Ae.propsKeywords){if(f&&typeof f=="object")for(var y in f)Ft(e,t,r,f[y],s+"/"+d+"/"+oa(y),o,s,d,n,y)}else(d in Ae.keywords||e.allKeys&&!(d in Ae.skipKeywords))&&Ft(e,t,r,f,s+"/"+d,o,s,d,n)}r(n,s,o,i,a,c,u)}}function oa(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(ce,"__esModule",{value:!0});ce.getSchemaRefs=ce.resolveUrl=ce.normalizeId=ce._getFullPath=ce.getFullPath=ce.inlineRef=void 0;const aa=C,ia=Os,ca=js.exports,la=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function ua(e,t=!0){return typeof e=="boolean"?!0:t===!0?!Er(e):t?Is(e)<=t:!1}ce.inlineRef=ua;const da=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Er(e){for(const t in e){if(da.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(Er)||typeof r=="object"&&Er(r))return!0}return!1}function Is(e){let t=0;for(const r in e){if(r==="$ref")return 1/0;if(t++,!la.has(r)&&(typeof e[r]=="object"&&(0,aa.eachItem)(e[r],n=>t+=Is(n)),t===1/0))return 1/0}return t}function Ts(e,t="",r){r!==!1&&(t=rt(t));const n=e.parse(t);return Rs(e,n)}ce.getFullPath=Ts;function Rs(e,t){return e.serialize(t).split("#")[0]+"#"}ce._getFullPath=Rs;const fa=/#\/?$/;function rt(e){return e?e.replace(fa,""):""}ce.normalizeId=rt;function ha(e,t,r){return r=rt(r),e.resolve(t,r)}ce.resolveUrl=ha;const pa=/^[a-z_][-a-z0-9._]*$/i;function ma(e,t){if(typeof e=="boolean")return{};const{schemaId:r,uriResolver:n}=this.opts,s=rt(e[r]||t),o={"":s},i=Ts(n,s,!1),a={},c=new Set;return ca(e,{allKeys:!0},(f,g,y,m)=>{if(m===void 0)return;const _=i+g;let $=o[m];typeof f[r]=="string"&&($=h.call(this,f[r])),w.call(this,f.$anchor),w.call(this,f.$dynamicAnchor),o[g]=$;function h(P){const O=this.opts.uriResolver.resolve;if(P=rt($?O($,P):P),c.has(P))throw d(P);c.add(P);let I=this.refs[P];return typeof I=="string"&&(I=this.refs[I]),typeof I=="object"?u(f,I.schema,P):P!==rt(_)&&(P[0]==="#"?(u(f,a[P],P),a[P]=f):this.refs[P]=_),P}function w(P){if(typeof P=="string"){if(!pa.test(P))throw new Error(`invalid anchor "${P}"`);h.call(this,`#${P}`)}}}),a;function u(f,g,y){if(g!==void 0&&!ia(f,g))throw d(y)}function d(f){return new Error(`reference "${f}" resolves to more than one schema`)}}ce.getSchemaRefs=ma;var Kn;function rr(){if(Kn)return Ie;Kn=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.getData=Ie.KeywordCxt=Ie.validateFunctionCode=void 0;const e=jo(),t=ne,r=Re,n=ne,s=xo(),o=na(),i=sa(),a=F,c=je,u=ce,d=C,f=It;function g(v){if(I(v)&&(D(v),O(v))){$(v);return}y(v,()=>(0,e.topBoolOrEmptySchema)(v))}Ie.validateFunctionCode=g;function y({gen:v,validateName:S,schema:N,schemaEnv:T,opts:V},z){V.code.es5?v.func(S,(0,a._)`${c.default.data}, ${c.default.valCxt}`,T.$async,()=>{v.code((0,a._)`"use strict"; ${w(N,V)}`),_(v,V),v.code(z)}):v.func(S,(0,a._)`${c.default.data}, ${m(V)}`,T.$async,()=>v.code(w(N,V)).code(z))}function m(v){return(0,a._)`{${c.default.instancePath}="", ${c.default.parentData}, ${c.default.parentDataProperty}, ${c.default.rootData}=${c.default.data}${v.dynamicRef?(0,a._)`, ${c.default.dynamicAnchors}={}`:a.nil}}={}`}function _(v,S){v.if(c.default.valCxt,()=>{v.var(c.default.instancePath,(0,a._)`${c.default.valCxt}.${c.default.instancePath}`),v.var(c.default.parentData,(0,a._)`${c.default.valCxt}.${c.default.parentData}`),v.var(c.default.parentDataProperty,(0,a._)`${c.default.valCxt}.${c.default.parentDataProperty}`),v.var(c.default.rootData,(0,a._)`${c.default.valCxt}.${c.default.rootData}`),S.dynamicRef&&v.var(c.default.dynamicAnchors,(0,a._)`${c.default.valCxt}.${c.default.dynamicAnchors}`)},()=>{v.var(c.default.instancePath,(0,a._)`""`),v.var(c.default.parentData,(0,a._)`undefined`),v.var(c.default.parentDataProperty,(0,a._)`undefined`),v.var(c.default.rootData,c.default.data),S.dynamicRef&&v.var(c.default.dynamicAnchors,(0,a._)`{}`)})}function $(v){const{schema:S,opts:N,gen:T}=v;y(v,()=>{N.$comment&&S.$comment&&X(v),Q(v),T.let(c.default.vErrors,null),T.let(c.default.errors,0),N.unevaluated&&h(v),J(v),ee(v)})}function h(v){const{gen:S,validateName:N}=v;v.evaluated=S.const("evaluated",(0,a._)`${N}.evaluated`),S.if((0,a._)`${v.evaluated}.dynamicProps`,()=>S.assign((0,a._)`${v.evaluated}.props`,(0,a._)`undefined`)),S.if((0,a._)`${v.evaluated}.dynamicItems`,()=>S.assign((0,a._)`${v.evaluated}.items`,(0,a._)`undefined`))}function w(v,S){const N=typeof v=="object"&&v[S.schemaId];return N&&(S.code.source||S.code.process)?(0,a._)`/*# sourceURL=${N} */`:a.nil}function P(v,S){if(I(v)&&(D(v),O(v))){R(v,S);return}(0,e.boolOrEmptySchema)(v,S)}function O({schema:v,self:S}){if(typeof v=="boolean")return!v;for(const N in v)if(S.RULES.all[N])return!0;return!1}function I(v){return typeof v.schema!="boolean"}function R(v,S){const{schema:N,gen:T,opts:V}=v;V.$comment&&N.$comment&&X(v),re(v),Z(v);const z=T.const("_errs",c.default.errors);J(v,z),T.var(S,(0,a._)`${z} === ${c.default.errors}`)}function D(v){(0,d.checkUnknownRules)(v),G(v)}function J(v,S){if(v.opts.jtd)return qe(v,[],!1,S);const N=(0,t.getSchemaTypes)(v.schema),T=(0,t.coerceAndCheckDataType)(v,N);qe(v,N,!T,S)}function G(v){const{schema:S,errSchemaPath:N,opts:T,self:V}=v;S.$ref&&T.ignoreKeywordsWithRef&&(0,d.schemaHasRulesButRef)(S,V.RULES)&&V.logger.warn(`$ref: keywords ignored in schema at path "${N}"`)}function Q(v){const{schema:S,opts:N}=v;S.default!==void 0&&N.useDefaults&&N.strictSchema&&(0,d.checkStrictMode)(v,"default is ignored in the schema root")}function re(v){const S=v.schema[v.opts.schemaId];S&&(v.baseId=(0,u.resolveUrl)(v.opts.uriResolver,v.baseId,S))}function Z(v){if(v.schema.$async&&!v.schemaEnv.$async)throw new Error("async schema in sync schema")}function X({gen:v,schemaEnv:S,schema:N,errSchemaPath:T,opts:V}){const z=N.$comment;if(V.$comment===!0)v.code((0,a._)`${c.default.self}.logger.log(${z})`);else if(typeof V.$comment=="function"){const oe=(0,a.str)`${T}/$comment`,_e=v.scopeValue("root",{ref:S.root});v.code((0,a._)`${c.default.self}.opts.$comment(${z}, ${oe}, ${_e}.schema)`)}}function ee(v){const{gen:S,schemaEnv:N,validateName:T,ValidationError:V,opts:z}=v;N.$async?S.if((0,a._)`${c.default.errors} === 0`,()=>S.return(c.default.data),()=>S.throw((0,a._)`new ${V}(${c.default.vErrors})`)):(S.assign((0,a._)`${T}.errors`,c.default.vErrors),z.unevaluated&&me(v),S.return((0,a._)`${c.default.errors} === 0`))}function me({gen:v,evaluated:S,props:N,items:T}){N instanceof a.Name&&v.assign((0,a._)`${S}.props`,N),T instanceof a.Name&&v.assign((0,a._)`${S}.items`,T)}function qe(v,S,N,T){const{gen:V,schema:z,data:oe,allErrors:_e,opts:de,self:fe}=v,{RULES:ae}=fe;if(z.$ref&&(de.ignoreKeywordsWithRef||!(0,d.schemaHasRulesButRef)(z,ae))){V.block(()=>A(v,"$ref",ae.all.$ref.definition));return}de.jtd||ut(v,S),V.block(()=>{for(const ye of ae.rules)Xe(ye);Xe(ae.post)});function Xe(ye){!(0,r.shouldUseGroup)(z,ye)||(ye.type?(V.if((0,n.checkDataType)(ye.type,oe,de.strictNumbers)),Be(v,ye),S.length===1&&S[0]===ye.type&&N&&(V.else(),(0,n.reportTypeError)(v)),V.endIf()):Be(v,ye),_e||V.if((0,a._)`${c.default.errors} === ${T||0}`))}}function Be(v,S){const{gen:N,schema:T,opts:{useDefaults:V}}=v;V&&(0,s.assignDefaults)(v,S.type),N.block(()=>{for(const z of S.rules)(0,r.shouldUseRule)(T,z)&&A(v,z.keyword,z.definition,S.type)})}function ut(v,S){v.schemaEnv.meta||!v.opts.strictTypes||(Qe(v,S),v.opts.allowUnionTypes||M(v,S),b(v,v.dataTypes))}function Qe(v,S){if(!!S.length){if(!v.dataTypes.length){v.dataTypes=S;return}S.forEach(N=>{E(v.dataTypes,N)||p(v,`type "${N}" not allowed by context "${v.dataTypes.join(",")}"`)}),l(v,S)}}function M(v,S){S.length>1&&!(S.length===2&&S.includes("null"))&&p(v,"use allowUnionTypes to allow union type keyword")}function b(v,S){const N=v.self.RULES.all;for(const T in N){const V=N[T];if(typeof V=="object"&&(0,r.shouldUseRule)(v.schema,V)){const{type:z}=V.definition;z.length&&!z.some(oe=>j(S,oe))&&p(v,`missing type "${z.join(",")}" for keyword "${T}"`)}}}function j(v,S){return v.includes(S)||S==="number"&&v.includes("integer")}function E(v,S){return v.includes(S)||S==="integer"&&v.includes("number")}function l(v,S){const N=[];for(const T of v.dataTypes)E(S,T)?N.push(T):S.includes("integer")&&T==="number"&&N.push("integer");v.dataTypes=N}function p(v,S){const N=v.schemaEnv.baseId+v.errSchemaPath;S+=` at "${N}" (strictTypes)`,(0,d.checkStrictMode)(v,S,v.opts.strictTypes)}class k{constructor(S,N,T){if((0,o.validateKeywordUsage)(S,N,T),this.gen=S.gen,this.allErrors=S.allErrors,this.keyword=T,this.data=S.data,this.schema=S.schema[T],this.$data=N.$data&&S.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,d.schemaRefOrVal)(S,this.schema,T,this.$data),this.schemaType=N.schemaType,this.parentSchema=S.schema,this.params={},this.it=S,this.def=N,this.$data)this.schemaCode=S.gen.const("vSchema",U(this.$data,S));else if(this.schemaCode=this.schemaValue,!(0,o.validSchemaType)(this.schema,N.schemaType,N.allowUndefined))throw new Error(`${T} value must be ${JSON.stringify(N.schemaType)}`);("code"in N?N.trackErrors:N.errors!==!1)&&(this.errsCount=S.gen.const("_errs",c.default.errors))}result(S,N,T){this.failResult((0,a.not)(S),N,T)}failResult(S,N,T){this.gen.if(S),T?T():this.error(),N?(this.gen.else(),N(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(S,N){this.failResult((0,a.not)(S),void 0,N)}fail(S){if(S===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(S),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(S){if(!this.$data)return this.fail(S);const{schemaCode:N}=this;this.fail((0,a._)`${N} !== undefined && (${(0,a.or)(this.invalid$data(),S)})`)}error(S,N,T){if(N){this.setParams(N),this._error(S,T),this.setParams({});return}this._error(S,T)}_error(S,N){(S?f.reportExtraError:f.reportError)(this,this.def.error,N)}$dataError(){(0,f.reportError)(this,this.def.$dataError||f.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,f.resetErrorsCount)(this.gen,this.errsCount)}ok(S){this.allErrors||this.gen.if(S)}setParams(S,N){N?Object.assign(this.params,S):this.params=S}block$data(S,N,T=a.nil){this.gen.block(()=>{this.check$data(S,T),N()})}check$data(S=a.nil,N=a.nil){if(!this.$data)return;const{gen:T,schemaCode:V,schemaType:z,def:oe}=this;T.if((0,a.or)((0,a._)`${V} === undefined`,N)),S!==a.nil&&T.assign(S,!0),(z.length||oe.validateSchema)&&(T.elseIf(this.invalid$data()),this.$dataError(),S!==a.nil&&T.assign(S,!1)),T.else()}invalid$data(){const{gen:S,schemaCode:N,schemaType:T,def:V,it:z}=this;return(0,a.or)(oe(),_e());function oe(){if(T.length){if(!(N instanceof a.Name))throw new Error("ajv implementation error");const de=Array.isArray(T)?T:[T];return(0,a._)`${(0,n.checkDataTypes)(de,N,z.opts.strictNumbers,n.DataType.Wrong)}`}return a.nil}function _e(){if(V.validateSchema){const de=S.scopeValue("validate$data",{ref:V.validateSchema});return(0,a._)`!${de}(${N})`}return a.nil}}subschema(S,N){const T=(0,i.getSubschema)(this.it,S);(0,i.extendSubschemaData)(T,this.it,S),(0,i.extendSubschemaMode)(T,S);const V={...this.it,...T,items:void 0,props:void 0};return P(V,N),V}mergeEvaluated(S,N){const{it:T,gen:V}=this;!T.opts.unevaluated||(T.props!==!0&&S.props!==void 0&&(T.props=d.mergeEvaluated.props(V,S.props,T.props,N)),T.items!==!0&&S.items!==void 0&&(T.items=d.mergeEvaluated.items(V,S.items,T.items,N)))}mergeValidEvaluated(S,N){const{it:T,gen:V}=this;if(T.opts.unevaluated&&(T.props!==!0||T.items!==!0))return V.if(N,()=>this.mergeEvaluated(S,a.Name)),!0}}Ie.KeywordCxt=k;function A(v,S,N,T){const V=new k(v,N,S);"code"in N?N.code(V,T):V.$data&&N.validate?(0,o.funcKeywordCode)(V,N):"macro"in N?(0,o.macroKeywordCode)(V,N):(N.compile||N.validate)&&(0,o.funcKeywordCode)(V,N)}const L=/^\/(?:[^~]|~0|~1)*$/,W=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function U(v,{dataLevel:S,dataNames:N,dataPathArr:T}){let V,z;if(v==="")return c.default.rootData;if(v[0]==="/"){if(!L.test(v))throw new Error(`Invalid JSON-pointer: ${v}`);V=v,z=c.default.rootData}else{const fe=W.exec(v);if(!fe)throw new Error(`Invalid JSON-pointer: ${v}`);const ae=+fe[1];if(V=fe[2],V==="#"){if(ae>=S)throw new Error(de("property/index",ae));return T[S-ae]}if(ae>S)throw new Error(de("data",ae));if(z=N[S-ae],!V)return z}let oe=z;const _e=V.split("/");for(const fe of _e)fe&&(z=(0,a._)`${z}${(0,a.getProperty)((0,d.unescapeJsonPointer)(fe))}`,oe=(0,a._)`${oe} && ${z}`);return oe;function de(fe,ae){return`Cannot access ${fe} ${ae} levels up, current level is ${S}`}}return Ie.getData=U,Ie}var Tt={};Object.defineProperty(Tt,"__esModule",{value:!0});class ya extends Error{constructor(t){super("validation failed"),this.errors=t,this.ajv=this.validation=!0}}Tt.default=ya;var it={};Object.defineProperty(it,"__esModule",{value:!0});const mr=ce;class ga extends Error{constructor(t,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,mr.resolveUrl)(t,r,n),this.missingSchema=(0,mr.normalizeId)((0,mr.getFullPath)(t,this.missingRef))}}it.default=ga;var pe={};Object.defineProperty(pe,"__esModule",{value:!0});pe.resolveSchema=pe.getCompilingSchema=pe.resolveRef=pe.compileSchema=pe.SchemaEnv=void 0;const we=F,$a=Tt,He=je,Se=ce,Un=C,_a=rr();class nr{constructor(t){var r;this.refs={},this.dynamicAnchors={};let n;typeof t.schema=="object"&&(n=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=(r=t.baseId)!==null&&r!==void 0?r:(0,Se.normalizeId)(n?.[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=n?.$async,this.refs={}}}pe.SchemaEnv=nr;function Hr(e){const t=Ms.call(this,e);if(t)return t;const r=(0,Se.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:o}=this.opts,i=new we.CodeGen(this.scope,{es5:n,lines:s,ownProperties:o});let a;e.$async&&(a=i.scopeValue("Error",{ref:$a.default,code:(0,we._)`require("ajv/dist/runtime/validation_error").default`}));const c=i.scopeName("validate");e.validateName=c;const u={gen:i,allErrors:this.opts.allErrors,data:He.default.data,parentData:He.default.parentData,parentDataProperty:He.default.parentDataProperty,dataNames:[He.default.data],dataPathArr:[we.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:e.schema,code:(0,we.stringify)(e.schema)}:{ref:e.schema}),validateName:c,ValidationError:a,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:we.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,we._)`""`,opts:this.opts,self:this};let d;try{this._compilations.add(e),(0,_a.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);const f=i.toString();d=`${i.scopeRefs(He.default.scope)}return ${f}`,this.opts.code.process&&(d=this.opts.code.process(d,e));const y=new Function(`${He.default.self}`,`${He.default.scope}`,d)(this,this.scope.get());if(this.scope.value(c,{ref:y}),y.errors=null,y.schema=e.schema,y.schemaEnv=e,e.$async&&(y.$async=!0),this.opts.code.source===!0&&(y.source={validateName:c,validateCode:f,scopeValues:i._values}),this.opts.unevaluated){const{props:m,items:_}=u;y.evaluated={props:m instanceof we.Name?void 0:m,items:_ instanceof we.Name?void 0:_,dynamicProps:m instanceof we.Name,dynamicItems:_ instanceof we.Name},y.source&&(y.source.evaluated=(0,we.stringify)(y.evaluated))}return e.validate=y,e}catch(f){throw delete e.validate,delete e.validateName,d&&this.logger.error("Error compiling schema, function code:",d),f}finally{this._compilations.delete(e)}}pe.compileSchema=Hr;function va(e,t,r){var n;r=(0,Se.resolveUrl)(this.opts.uriResolver,t,r);const s=e.refs[r];if(s)return s;let o=Sa.call(this,e,r);if(o===void 0){const i=(n=e.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(o=new nr({schema:i,schemaId:a,root:e,baseId:t}))}if(o!==void 0)return e.refs[r]=wa.call(this,o)}pe.resolveRef=va;function wa(e){return(0,Se.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:Hr.call(this,e)}function Ms(e){for(const t of this._compilations)if(ba(t,e))return t}pe.getCompilingSchema=Ms;function ba(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function Sa(e,t){let r;for(;typeof(r=this.refs[t])=="string";)t=r;return r||this.schemas[t]||sr.call(this,e,t)}function sr(e,t){const r=this.opts.uriResolver.parse(t),n=(0,Se._getFullPath)(this.opts.uriResolver,r);let s=(0,Se.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&n===s)return yr.call(this,r,e);const o=(0,Se.normalizeId)(n),i=this.refs[o]||this.schemas[o];if(typeof i=="string"){const a=sr.call(this,e,i);return typeof a?.schema!="object"?void 0:yr.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||Hr.call(this,i),o===(0,Se.normalizeId)(t)){const{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(s=(0,Se.resolveUrl)(this.opts.uriResolver,s,u)),new nr({schema:a,schemaId:c,root:e,baseId:s})}return yr.call(this,r,i)}}pe.resolveSchema=sr;const Ea=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function yr(e,{baseId:t,schema:r,root:n}){var s;if(((s=e.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(const a of e.fragment.slice(1).split("/")){if(typeof r=="boolean")return;const c=r[(0,Un.unescapeFragment)(a)];if(c===void 0)return;r=c;const u=typeof r=="object"&&r[this.opts.schemaId];!Ea.has(a)&&u&&(t=(0,Se.resolveUrl)(this.opts.uriResolver,t,u))}let o;if(typeof r!="boolean"&&r.$ref&&!(0,Un.schemaHasRulesButRef)(r,this.RULES)){const a=(0,Se.resolveUrl)(this.opts.uriResolver,t,r.$ref);o=sr.call(this,n,a)}const{schemaId:i}=this.opts;if(o=o||new nr({schema:r,schemaId:i,root:n,baseId:t}),o.schema!==o.root.schema)return o}const Pa="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",ka="Meta-schema for $data reference (JSON AnySchema extension proposal)",Na="object",Oa=["$data"],ja={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},Ia=!1,Ta={$id:Pa,description:ka,type:Na,required:Oa,properties:ja,additionalProperties:Ia};var Fr={},or={exports:{}};const Ra=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),Cs=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function Kr(e){let t="",r=0,n=0;for(n=0;n<e.length;n++)if(r=e[n].charCodeAt(0),r!==48){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";t+=e[n];break}for(n+=1;n<e.length;n++){if(r=e[n].charCodeAt(0),!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";t+=e[n]}return t}const Ma=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function xn(e){return e.length=0,!0}function Ca(e,t,r){if(e.length){const n=Kr(e);if(n!=="")t.push(n);else return r.error=!0,!1;e.length=0}return!0}function Da(e){let t=0;const r={error:!1,address:"",zone:""},n=[],s=[];let o=!1,i=!1,a=Ca;for(let c=0;c<e.length;c++){const u=e[c];if(!(u==="["||u==="]"))if(u===":"){if(o===!0&&(i=!0),!a(s,n,r))break;if(++t>7){r.error=!0;break}c>0&&e[c-1]===":"&&(o=!0),n.push(":");continue}else if(u==="%"){if(!a(s,n,r))break;a=xn}else{s.push(u);continue}}return s.length&&(a===xn?r.zone=s.join(""):i?n.push(s.join("")):n.push(Kr(s))),r.address=n.join(""),r}function Ds(e){if(Aa(e,":")<2)return{host:e,isIPV6:!1};const t=Da(e);if(t.error)return{host:e,isIPV6:!1};{let r=t.address,n=t.address;return t.zone&&(r+="%"+t.zone,n+="%25"+t.zone),{host:r,isIPV6:!0,escapedHost:n}}}function Aa(e,t){let r=0;for(let n=0;n<e.length;n++)e[n]===t&&r++;return r}function Va(e){let t=e;const r=[];let n=-1,s=0;for(;s=t.length;){if(s===1){if(t===".")break;if(t==="/"){r.push("/");break}else{r.push(t);break}}else if(s===2){if(t[0]==="."){if(t[1]===".")break;if(t[1]==="/"){t=t.slice(2);continue}}else if(t[0]==="/"&&(t[1]==="."||t[1]==="/")){r.push("/");break}}else if(s===3&&t==="/.."){r.length!==0&&r.pop(),r.push("/");break}if(t[0]==="."){if(t[1]==="."){if(t[2]==="/"){t=t.slice(3);continue}}else if(t[1]==="/"){t=t.slice(2);continue}}else if(t[0]==="/"&&t[1]==="."){if(t[2]==="/"){t=t.slice(2);continue}else if(t[2]==="."&&t[3]==="/"){t=t.slice(3),r.length!==0&&r.pop();continue}}if((n=t.indexOf("/",1))===-1){r.push(t);break}else r.push(t.slice(0,n)),t=t.slice(n)}return r.join("")}function La(e,t){const r=t!==!0?escape:unescape;return e.scheme!==void 0&&(e.scheme=r(e.scheme)),e.userinfo!==void 0&&(e.userinfo=r(e.userinfo)),e.host!==void 0&&(e.host=r(e.host)),e.path!==void 0&&(e.path=r(e.path)),e.query!==void 0&&(e.query=r(e.query)),e.fragment!==void 0&&(e.fragment=r(e.fragment)),e}function qa(e){const t=[];if(e.userinfo!==void 0&&(t.push(e.userinfo),t.push("@")),e.host!==void 0){let r=unescape(e.host);if(!Cs(r)){const n=Ds(r);n.isIPV6===!0?r=`[${n.escapedHost}]`:r=e.host}t.push(r)}return(typeof e.port=="number"||typeof e.port=="string")&&(t.push(":"),t.push(String(e.port))),t.length?t.join(""):void 0}var As={nonSimpleDomain:Ma,recomposeAuthority:qa,normalizeComponentEncoding:La,removeDotSegments:Va,isIPv4:Cs,isUUID:Ra,normalizeIPv6:Ds,stringArrayToHexStripped:Kr};const{isUUID:za}=As,Ha=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,Fa=["http","https","ws","wss","urn","urn:uuid"];function Ka(e){return Fa.indexOf(e)!==-1}function Ur(e){return e.secure===!0?!0:e.secure===!1?!1:e.scheme?e.scheme.length===3&&(e.scheme[0]==="w"||e.scheme[0]==="W")&&(e.scheme[1]==="s"||e.scheme[1]==="S")&&(e.scheme[2]==="s"||e.scheme[2]==="S"):!1}function Vs(e){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e}function Ls(e){const t=String(e.scheme).toLowerCase()==="https";return(e.port===(t?443:80)||e.port==="")&&(e.port=void 0),e.path||(e.path="/"),e}function Ua(e){return e.secure=Ur(e),e.resourceName=(e.path||"/")+(e.query?"?"+e.query:""),e.path=void 0,e.query=void 0,e}function xa(e){if((e.port===(Ur(e)?443:80)||e.port==="")&&(e.port=void 0),typeof e.secure=="boolean"&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){const[t,r]=e.resourceName.split("?");e.path=t&&t!=="/"?t:void 0,e.query=r,e.resourceName=void 0}return e.fragment=void 0,e}function Ja(e,t){if(!e.path)return e.error="URN can not be parsed",e;const r=e.path.match(Ha);if(r){const n=t.scheme||e.scheme||"urn";e.nid=r[1].toLowerCase(),e.nss=r[2];const s=`${n}:${t.nid||e.nid}`,o=xr(s);e.path=void 0,o&&(e=o.parse(e,t))}else e.error=e.error||"URN can not be parsed.";return e}function Ga(e,t){if(e.nid===void 0)throw new Error("URN without nid cannot be serialized");const r=t.scheme||e.scheme||"urn",n=e.nid.toLowerCase(),s=`${r}:${t.nid||n}`,o=xr(s);o&&(e=o.serialize(e,t));const i=e,a=e.nss;return i.path=`${n||t.nid}:${a}`,t.skipEscape=!0,i}function Wa(e,t){const r=e;return r.uuid=r.nss,r.nss=void 0,!t.tolerant&&(!r.uuid||!za(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function Ba(e){const t=e;return t.nss=(e.uuid||"").toLowerCase(),t}const qs={scheme:"http",domainHost:!0,parse:Vs,serialize:Ls},Qa={scheme:"https",domainHost:qs.domainHost,parse:Vs,serialize:Ls},Kt={scheme:"ws",domainHost:!0,parse:Ua,serialize:xa},Xa={scheme:"wss",domainHost:Kt.domainHost,parse:Kt.parse,serialize:Kt.serialize},Ya={scheme:"urn",parse:Ja,serialize:Ga,skipNormalize:!0},Za={scheme:"urn:uuid",parse:Wa,serialize:Ba,skipNormalize:!0},Bt={http:qs,https:Qa,ws:Kt,wss:Xa,urn:Ya,"urn:uuid":Za};Object.setPrototypeOf(Bt,null);function xr(e){return e&&(Bt[e]||Bt[e.toLowerCase()])||void 0}var ei={wsIsSecure:Ur,SCHEMES:Bt,isValidSchemeName:Ka,getSchemeHandler:xr};const{normalizeIPv6:ti,removeDotSegments:pt,recomposeAuthority:ri,normalizeComponentEncoding:Dt,isIPv4:ni,nonSimpleDomain:si}=As,{SCHEMES:oi,getSchemeHandler:zs}=ei;function ai(e,t){return typeof e=="string"?e=Ne(Me(e,t),t):typeof e=="object"&&(e=Me(Ne(e,t),t)),e}function ii(e,t,r){const n=r?Object.assign({scheme:"null"},r):{scheme:"null"},s=Hs(Me(e,n),Me(t,n),n,!0);return n.skipEscape=!0,Ne(s,n)}function Hs(e,t,r,n){const s={};return n||(e=Me(Ne(e,r),r),t=Me(Ne(t,r),r)),r=r||{},!r.tolerant&&t.scheme?(s.scheme=t.scheme,s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=pt(t.path||""),s.query=t.query):(t.userinfo!==void 0||t.host!==void 0||t.port!==void 0?(s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=pt(t.path||""),s.query=t.query):(t.path?(t.path[0]==="/"?s.path=pt(t.path):((e.userinfo!==void 0||e.host!==void 0||e.port!==void 0)&&!e.path?s.path="/"+t.path:e.path?s.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:s.path=t.path,s.path=pt(s.path)),s.query=t.query):(s.path=e.path,t.query!==void 0?s.query=t.query:s.query=e.query),s.userinfo=e.userinfo,s.host=e.host,s.port=e.port),s.scheme=e.scheme),s.fragment=t.fragment,s}function ci(e,t,r){return typeof e=="string"?(e=unescape(e),e=Ne(Dt(Me(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=Ne(Dt(e,!0),{...r,skipEscape:!0})),typeof t=="string"?(t=unescape(t),t=Ne(Dt(Me(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=Ne(Dt(t,!0),{...r,skipEscape:!0})),e.toLowerCase()===t.toLowerCase()}function Ne(e,t){const r={host:e.host,scheme:e.scheme,userinfo:e.userinfo,port:e.port,path:e.path,query:e.query,nid:e.nid,nss:e.nss,uuid:e.uuid,fragment:e.fragment,reference:e.reference,resourceName:e.resourceName,secure:e.secure,error:""},n=Object.assign({},t),s=[],o=zs(n.scheme||r.scheme);o&&o.serialize&&o.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&s.push(r.scheme,":");const i=ri(r);if(i!==void 0&&(n.reference!=="suffix"&&s.push("//"),s.push(i),r.path&&r.path[0]!=="/"&&s.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!o||!o.absolutePath)&&(a=pt(a)),i===void 0&&a[0]==="/"&&a[1]==="/"&&(a="/%2F"+a.slice(2)),s.push(a)}return r.query!==void 0&&s.push("?",r.query),r.fragment!==void 0&&s.push("#",r.fragment),s.join("")}const li=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function Me(e,t){const r=Object.assign({},t),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0};let s=!1;r.reference==="suffix"&&(r.scheme?e=r.scheme+":"+e:e="//"+e);const o=e.match(li);if(o){if(n.scheme=o[1],n.userinfo=o[3],n.host=o[4],n.port=parseInt(o[5],10),n.path=o[6]||"",n.query=o[7],n.fragment=o[8],isNaN(n.port)&&(n.port=o[5]),n.host)if(ni(n.host)===!1){const c=ti(n.host);n.host=c.host.toLowerCase(),s=c.isIPV6}else s=!0;n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&n.query===void 0&&!n.path?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");const i=zs(r.scheme||n.scheme);if(!r.unicodeSupport&&(!i||!i.unicodeSupport)&&n.host&&(r.domainHost||i&&i.domainHost)&&s===!1&&si(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(a){n.error=n.error||"Host's domain name can not be converted to ASCII: "+a}(!i||i&&!i.skipNormalize)&&(e.indexOf("%")!==-1&&(n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),n.host!==void 0&&(n.host=unescape(n.host))),n.path&&(n.path=escape(unescape(n.path))),n.fragment&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),i&&i.parse&&i.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}const Jr={SCHEMES:oi,normalize:ai,resolve:ii,resolveComponent:Hs,equal:ci,serialize:Ne,parse:Me};or.exports=Jr;or.exports.default=Jr;or.exports.fastUri=Jr;Object.defineProperty(Fr,"__esModule",{value:!0});const Fs=or.exports;Fs.code='require("ajv/dist/runtime/uri").default';Fr.default=Fs;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=rr();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=F;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=Tt,s=it,o=Je,i=pe,a=F,c=ce,u=ne,d=C,f=Ta,g=Fr,y=(M,b)=>new RegExp(M,b);y.code="new RegExp";const m=["removeAdditional","useDefaults","coerceTypes"],_=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),$={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},h={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},w=200;function P(M){var b,j,E,l,p,k,A,L,W,U,v,S,N,T,V,z,oe,_e,de,fe,ae,Xe,ye,dr,fr;const dt=M.strict,hr=(b=M.code)===null||b===void 0?void 0:b.optimize,Cn=hr===!0||hr===void 0?1:hr||0,Dn=(E=(j=M.code)===null||j===void 0?void 0:j.regExp)!==null&&E!==void 0?E:y,ho=(l=M.uriResolver)!==null&&l!==void 0?l:g.default;return{strictSchema:(k=(p=M.strictSchema)!==null&&p!==void 0?p:dt)!==null&&k!==void 0?k:!0,strictNumbers:(L=(A=M.strictNumbers)!==null&&A!==void 0?A:dt)!==null&&L!==void 0?L:!0,strictTypes:(U=(W=M.strictTypes)!==null&&W!==void 0?W:dt)!==null&&U!==void 0?U:"log",strictTuples:(S=(v=M.strictTuples)!==null&&v!==void 0?v:dt)!==null&&S!==void 0?S:"log",strictRequired:(T=(N=M.strictRequired)!==null&&N!==void 0?N:dt)!==null&&T!==void 0?T:!1,code:M.code?{...M.code,optimize:Cn,regExp:Dn}:{optimize:Cn,regExp:Dn},loopRequired:(V=M.loopRequired)!==null&&V!==void 0?V:w,loopEnum:(z=M.loopEnum)!==null&&z!==void 0?z:w,meta:(oe=M.meta)!==null&&oe!==void 0?oe:!0,messages:(_e=M.messages)!==null&&_e!==void 0?_e:!0,inlineRefs:(de=M.inlineRefs)!==null&&de!==void 0?de:!0,schemaId:(fe=M.schemaId)!==null&&fe!==void 0?fe:"$id",addUsedSchema:(ae=M.addUsedSchema)!==null&&ae!==void 0?ae:!0,validateSchema:(Xe=M.validateSchema)!==null&&Xe!==void 0?Xe:!0,validateFormats:(ye=M.validateFormats)!==null&&ye!==void 0?ye:!0,unicodeRegExp:(dr=M.unicodeRegExp)!==null&&dr!==void 0?dr:!0,int32range:(fr=M.int32range)!==null&&fr!==void 0?fr:!0,uriResolver:ho}}class O{constructor(b={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,b=this.opts={...b,...P(b)};const{es5:j,lines:E}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:_,es5:j,lines:E}),this.logger=Z(b.logger);const l=b.validateFormats;b.validateFormats=!1,this.RULES=(0,o.getRules)(),I.call(this,$,b,"NOT SUPPORTED"),I.call(this,h,b,"DEPRECATED","warn"),this._metaOpts=Q.call(this),b.formats&&J.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),b.keywords&&G.call(this,b.keywords),typeof b.meta=="object"&&this.addMetaSchema(b.meta),D.call(this),b.validateFormats=l}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:b,meta:j,schemaId:E}=this.opts;let l=f;E==="id"&&(l={...f},l.id=l.$id,delete l.$id),j&&b&&this.addMetaSchema(l,l[E],!1)}defaultMeta(){const{meta:b,schemaId:j}=this.opts;return this.opts.defaultMeta=typeof b=="object"?b[j]||b:void 0}validate(b,j){let E;if(typeof b=="string"){if(E=this.getSchema(b),!E)throw new Error(`no schema with key or ref "${b}"`)}else E=this.compile(b);const l=E(j);return"$async"in E||(this.errors=E.errors),l}compile(b,j){const E=this._addSchema(b,j);return E.validate||this._compileSchemaEnv(E)}compileAsync(b,j){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:E}=this.opts;return l.call(this,b,j);async function l(U,v){await p.call(this,U.$schema);const S=this._addSchema(U,v);return S.validate||k.call(this,S)}async function p(U){U&&!this.getSchema(U)&&await l.call(this,{$ref:U},!0)}async function k(U){try{return this._compileSchemaEnv(U)}catch(v){if(!(v instanceof s.default))throw v;return A.call(this,v),await L.call(this,v.missingSchema),k.call(this,U)}}function A({missingSchema:U,missingRef:v}){if(this.refs[U])throw new Error(`AnySchema ${U} is loaded but ${v} cannot be resolved`)}async function L(U){const v=await W.call(this,U);this.refs[U]||await p.call(this,v.$schema),this.refs[U]||this.addSchema(v,U,j)}async function W(U){const v=this._loading[U];if(v)return v;try{return await(this._loading[U]=E(U))}finally{delete this._loading[U]}}}addSchema(b,j,E,l=this.opts.validateSchema){if(Array.isArray(b)){for(const k of b)this.addSchema(k,void 0,E,l);return this}let p;if(typeof b=="object"){const{schemaId:k}=this.opts;if(p=b[k],p!==void 0&&typeof p!="string")throw new Error(`schema ${k} must be string`)}return j=(0,c.normalizeId)(j||p),this._checkUnique(j),this.schemas[j]=this._addSchema(b,E,j,l,!0),this}addMetaSchema(b,j,E=this.opts.validateSchema){return this.addSchema(b,j,!0,E),this}validateSchema(b,j){if(typeof b=="boolean")return!0;let E;if(E=b.$schema,E!==void 0&&typeof E!="string")throw new Error("$schema must be a string");if(E=E||this.opts.defaultMeta||this.defaultMeta(),!E)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const l=this.validate(E,b);if(!l&&j){const p="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(p);else throw new Error(p)}return l}getSchema(b){let j;for(;typeof(j=R.call(this,b))=="string";)b=j;if(j===void 0){const{schemaId:E}=this.opts,l=new i.SchemaEnv({schema:{},schemaId:E});if(j=i.resolveSchema.call(this,l,b),!j)return;this.refs[b]=j}return j.validate||this._compileSchemaEnv(j)}removeSchema(b){if(b instanceof RegExp)return this._removeAllSchemas(this.schemas,b),this._removeAllSchemas(this.refs,b),this;switch(typeof b){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const j=R.call(this,b);return typeof j=="object"&&this._cache.delete(j.schema),delete this.schemas[b],delete this.refs[b],this}case"object":{const j=b;this._cache.delete(j);let E=b[this.opts.schemaId];return E&&(E=(0,c.normalizeId)(E),delete this.schemas[E],delete this.refs[E]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(b){for(const j of b)this.addKeyword(j);return this}addKeyword(b,j){let E;if(typeof b=="string")E=b,typeof j=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),j.keyword=E);else if(typeof b=="object"&&j===void 0){if(j=b,E=j.keyword,Array.isArray(E)&&!E.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(ee.call(this,E,j),!j)return(0,d.eachItem)(E,p=>me.call(this,p)),this;Be.call(this,j);const l={...j,type:(0,u.getJSONTypes)(j.type),schemaType:(0,u.getJSONTypes)(j.schemaType)};return(0,d.eachItem)(E,l.type.length===0?p=>me.call(this,p,l):p=>l.type.forEach(k=>me.call(this,p,l,k))),this}getKeyword(b){const j=this.RULES.all[b];return typeof j=="object"?j.definition:!!j}removeKeyword(b){const{RULES:j}=this;delete j.keywords[b],delete j.all[b];for(const E of j.rules){const l=E.rules.findIndex(p=>p.keyword===b);l>=0&&E.rules.splice(l,1)}return this}addFormat(b,j){return typeof j=="string"&&(j=new RegExp(j)),this.formats[b]=j,this}errorsText(b=this.errors,{separator:j=", ",dataVar:E="data"}={}){return!b||b.length===0?"No errors":b.map(l=>`${E}${l.instancePath} ${l.message}`).reduce((l,p)=>l+j+p)}$dataMetaSchema(b,j){const E=this.RULES.all;b=JSON.parse(JSON.stringify(b));for(const l of j){const p=l.split("/").slice(1);let k=b;for(const A of p)k=k[A];for(const A in E){const L=E[A];if(typeof L!="object")continue;const{$data:W}=L.definition,U=k[A];W&&U&&(k[A]=Qe(U))}}return b}_removeAllSchemas(b,j){for(const E in b){const l=b[E];(!j||j.test(E))&&(typeof l=="string"?delete b[E]:l&&!l.meta&&(this._cache.delete(l.schema),delete b[E]))}}_addSchema(b,j,E,l=this.opts.validateSchema,p=this.opts.addUsedSchema){let k;const{schemaId:A}=this.opts;if(typeof b=="object")k=b[A];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof b!="boolean")throw new Error("schema must be object or boolean")}let L=this._cache.get(b);if(L!==void 0)return L;E=(0,c.normalizeId)(k||E);const W=c.getSchemaRefs.call(this,b,E);return L=new i.SchemaEnv({schema:b,schemaId:A,meta:j,baseId:E,localRefs:W}),this._cache.set(L.schema,L),p&&!E.startsWith("#")&&(E&&this._checkUnique(E),this.refs[E]=L),l&&this.validateSchema(b,!0),L}_checkUnique(b){if(this.schemas[b]||this.refs[b])throw new Error(`schema with key or id "${b}" already exists`)}_compileSchemaEnv(b){if(b.meta?this._compileMetaSchema(b):i.compileSchema.call(this,b),!b.validate)throw new Error("ajv implementation error");return b.validate}_compileMetaSchema(b){const j=this.opts;this.opts=this._metaOpts;try{i.compileSchema.call(this,b)}finally{this.opts=j}}}O.ValidationError=n.default,O.MissingRefError=s.default,e.default=O;function I(M,b,j,E="error"){for(const l in M){const p=l;p in b&&this.logger[E](`${j}: option ${l}. ${M[p]}`)}}function R(M){return M=(0,c.normalizeId)(M),this.schemas[M]||this.refs[M]}function D(){const M=this.opts.schemas;if(!!M)if(Array.isArray(M))this.addSchema(M);else for(const b in M)this.addSchema(M[b],b)}function J(){for(const M in this.opts.formats){const b=this.opts.formats[M];b&&this.addFormat(M,b)}}function G(M){if(Array.isArray(M)){this.addVocabulary(M);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const b in M){const j=M[b];j.keyword||(j.keyword=b),this.addKeyword(j)}}function Q(){const M={...this.opts};for(const b of m)delete M[b];return M}const re={log(){},warn(){},error(){}};function Z(M){if(M===!1)return re;if(M===void 0)return console;if(M.log&&M.warn&&M.error)return M;throw new Error("logger must implement log, warn and error methods")}const X=/^[a-z_$][a-z0-9_$:-]*$/i;function ee(M,b){const{RULES:j}=this;if((0,d.eachItem)(M,E=>{if(j.keywords[E])throw new Error(`Keyword ${E} is already defined`);if(!X.test(E))throw new Error(`Keyword ${E} has invalid name`)}),!!b&&b.$data&&!("code"in b||"validate"in b))throw new Error('$data keyword must have "code" or "validate" function')}function me(M,b,j){var E;const l=b?.post;if(j&&l)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:p}=this;let k=l?p.post:p.rules.find(({type:L})=>L===j);if(k||(k={type:j,rules:[]},p.rules.push(k)),p.keywords[M]=!0,!b)return;const A={keyword:M,definition:{...b,type:(0,u.getJSONTypes)(b.type),schemaType:(0,u.getJSONTypes)(b.schemaType)}};b.before?qe.call(this,k,A,b.before):k.rules.push(A),p.all[M]=A,(E=b.implements)===null||E===void 0||E.forEach(L=>this.addKeyword(L))}function qe(M,b,j){const E=M.rules.findIndex(l=>l.keyword===j);E>=0?M.rules.splice(E,0,b):(M.rules.push(b),this.logger.warn(`rule ${j} is not defined`))}function Be(M){let{metaSchema:b}=M;b!==void 0&&(M.$data&&this.opts.$data&&(b=Qe(b)),M.validateSchema=this.compile(b,!0))}const ut={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Qe(M){return{anyOf:[M,ut]}}})(ms);var Gr={},Wr={},Br={};Object.defineProperty(Br,"__esModule",{value:!0});const ui={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Br.default=ui;var Ge={};Object.defineProperty(Ge,"__esModule",{value:!0});Ge.callRef=Ge.getValidate=void 0;const di=it,Jn=H,he=F,Ye=je,Gn=pe,At=C,fi={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:n}=e,{baseId:s,schemaEnv:o,validateName:i,opts:a,self:c}=n,{root:u}=o;if((r==="#"||r==="#/")&&s===u.baseId)return f();const d=Gn.resolveRef.call(c,u,s,r);if(d===void 0)throw new di.default(n.opts.uriResolver,s,r);if(d instanceof Gn.SchemaEnv)return g(d);return y(d);function f(){if(o===u)return Ut(e,i,o,o.$async);const m=t.scopeValue("root",{ref:u});return Ut(e,(0,he._)`${m}.validate`,u,u.$async)}function g(m){const _=Ks(e,m);Ut(e,_,m,m.$async)}function y(m){const _=t.scopeValue("schema",a.code.source===!0?{ref:m,code:(0,he.stringify)(m)}:{ref:m}),$=t.name("valid"),h=e.subschema({schema:m,dataTypes:[],schemaPath:he.nil,topSchemaRef:_,errSchemaPath:r},$);e.mergeEvaluated(h),e.ok($)}}};function Ks(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):(0,he._)`${r.scopeValue("wrapper",{ref:t})}.validate`}Ge.getValidate=Ks;function Ut(e,t,r,n){const{gen:s,it:o}=e,{allErrors:i,schemaEnv:a,opts:c}=o,u=c.passContext?Ye.default.this:he.nil;n?d():f();function d(){if(!a.$async)throw new Error("async schema referenced by sync schema");const m=s.let("valid");s.try(()=>{s.code((0,he._)`await ${(0,Jn.callValidateCode)(e,t,u)}`),y(t),i||s.assign(m,!0)},_=>{s.if((0,he._)`!(${_} instanceof ${o.ValidationError})`,()=>s.throw(_)),g(_),i||s.assign(m,!1)}),e.ok(m)}function f(){e.result((0,Jn.callValidateCode)(e,t,u),()=>y(t),()=>g(t))}function g(m){const _=(0,he._)`${m}.errors`;s.assign(Ye.default.vErrors,(0,he._)`${Ye.default.vErrors} === null ? ${_} : ${Ye.default.vErrors}.concat(${_})`),s.assign(Ye.default.errors,(0,he._)`${Ye.default.vErrors}.length`)}function y(m){var _;if(!o.opts.unevaluated)return;const $=(_=r?.validate)===null||_===void 0?void 0:_.evaluated;if(o.props!==!0)if($&&!$.dynamicProps)$.props!==void 0&&(o.props=At.mergeEvaluated.props(s,$.props,o.props));else{const h=s.var("props",(0,he._)`${m}.evaluated.props`);o.props=At.mergeEvaluated.props(s,h,o.props,he.Name)}if(o.items!==!0)if($&&!$.dynamicItems)$.items!==void 0&&(o.items=At.mergeEvaluated.items(s,$.items,o.items));else{const h=s.var("items",(0,he._)`${m}.evaluated.items`);o.items=At.mergeEvaluated.items(s,h,o.items,he.Name)}}}Ge.callRef=Ut;Ge.default=fi;Object.defineProperty(Wr,"__esModule",{value:!0});const hi=Br,pi=Ge,mi=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",hi.default,pi.default];Wr.default=mi;var Qr={},Xr={};Object.defineProperty(Xr,"__esModule",{value:!0});const Qt=F,De=Qt.operators,Xt={maximum:{okStr:"<=",ok:De.LTE,fail:De.GT},minimum:{okStr:">=",ok:De.GTE,fail:De.LT},exclusiveMaximum:{okStr:"<",ok:De.LT,fail:De.GTE},exclusiveMinimum:{okStr:">",ok:De.GT,fail:De.LTE}},yi={message:({keyword:e,schemaCode:t})=>(0,Qt.str)`must be ${Xt[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,Qt._)`{comparison: ${Xt[e].okStr}, limit: ${t}}`},gi={keyword:Object.keys(Xt),type:"number",schemaType:"number",$data:!0,error:yi,code(e){const{keyword:t,data:r,schemaCode:n}=e;e.fail$data((0,Qt._)`${r} ${Xt[t].fail} ${n} || isNaN(${r})`)}};Xr.default=gi;var Yr={};Object.defineProperty(Yr,"__esModule",{value:!0});const gt=F,$i={message:({schemaCode:e})=>(0,gt.str)`must be multiple of ${e}`,params:({schemaCode:e})=>(0,gt._)`{multipleOf: ${e}}`},_i={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:$i,code(e){const{gen:t,data:r,schemaCode:n,it:s}=e,o=s.opts.multipleOfPrecision,i=t.let("res"),a=o?(0,gt._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${o}`:(0,gt._)`${i} !== parseInt(${i})`;e.fail$data((0,gt._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};Yr.default=_i;var Zr={},en={};Object.defineProperty(en,"__esModule",{value:!0});function Us(e){const t=e.length;let r=0,n=0,s;for(;n<t;)r++,s=e.charCodeAt(n++),s>=55296&&s<=56319&&n<t&&(s=e.charCodeAt(n),(s&64512)===56320&&n++);return r}en.default=Us;Us.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(Zr,"__esModule",{value:!0});const Fe=F,vi=C,wi=en,bi={message({keyword:e,schemaCode:t}){const r=e==="maxLength"?"more":"fewer";return(0,Fe.str)`must NOT have ${r} than ${t} characters`},params:({schemaCode:e})=>(0,Fe._)`{limit: ${e}}`},Si={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:bi,code(e){const{keyword:t,data:r,schemaCode:n,it:s}=e,o=t==="maxLength"?Fe.operators.GT:Fe.operators.LT,i=s.opts.unicode===!1?(0,Fe._)`${r}.length`:(0,Fe._)`${(0,vi.useFunc)(e.gen,wi.default)}(${r})`;e.fail$data((0,Fe._)`${i} ${o} ${n}`)}};Zr.default=Si;var tn={};Object.defineProperty(tn,"__esModule",{value:!0});const Ei=H,Yt=F,Pi={message:({schemaCode:e})=>(0,Yt.str)`must match pattern "${e}"`,params:({schemaCode:e})=>(0,Yt._)`{pattern: ${e}}`},ki={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:Pi,code(e){const{data:t,$data:r,schema:n,schemaCode:s,it:o}=e,i=o.opts.unicodeRegExp?"u":"",a=r?(0,Yt._)`(new RegExp(${s}, ${i}))`:(0,Ei.usePattern)(e,n);e.fail$data((0,Yt._)`!${a}.test(${t})`)}};tn.default=ki;var rn={};Object.defineProperty(rn,"__esModule",{value:!0});const $t=F,Ni={message({keyword:e,schemaCode:t}){const r=e==="maxProperties"?"more":"fewer";return(0,$t.str)`must NOT have ${r} than ${t} properties`},params:({schemaCode:e})=>(0,$t._)`{limit: ${e}}`},Oi={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Ni,code(e){const{keyword:t,data:r,schemaCode:n}=e,s=t==="maxProperties"?$t.operators.GT:$t.operators.LT;e.fail$data((0,$t._)`Object.keys(${r}).length ${s} ${n}`)}};rn.default=Oi;var nn={};Object.defineProperty(nn,"__esModule",{value:!0});const ht=H,_t=F,ji=C,Ii={message:({params:{missingProperty:e}})=>(0,_t.str)`must have required property '${e}'`,params:({params:{missingProperty:e}})=>(0,_t._)`{missingProperty: ${e}}`},Ti={keyword:"required",type:"object",schemaType:"array",$data:!0,error:Ii,code(e){const{gen:t,schema:r,schemaCode:n,data:s,$data:o,it:i}=e,{opts:a}=i;if(!o&&r.length===0)return;const c=r.length>=a.loopRequired;if(i.allErrors?u():d(),a.strictRequired){const y=e.parentSchema.properties,{definedProperties:m}=e.it;for(const _ of r)if(y?.[_]===void 0&&!m.has(_)){const $=i.schemaEnv.baseId+i.errSchemaPath,h=`required property "${_}" is not defined at "${$}" (strictRequired)`;(0,ji.checkStrictMode)(i,h,i.opts.strictRequired)}}function u(){if(c||o)e.block$data(_t.nil,f);else for(const y of r)(0,ht.checkReportMissingProp)(e,y)}function d(){const y=t.let("missing");if(c||o){const m=t.let("valid",!0);e.block$data(m,()=>g(y,m)),e.ok(m)}else t.if((0,ht.checkMissingProp)(e,r,y)),(0,ht.reportMissingProp)(e,y),t.else()}function f(){t.forOf("prop",n,y=>{e.setParams({missingProperty:y}),t.if((0,ht.noPropertyInData)(t,s,y,a.ownProperties),()=>e.error())})}function g(y,m){e.setParams({missingProperty:y}),t.forOf(y,n,()=>{t.assign(m,(0,ht.propertyInData)(t,s,y,a.ownProperties)),t.if((0,_t.not)(m),()=>{e.error(),t.break()})},_t.nil)}}};nn.default=Ti;var sn={};Object.defineProperty(sn,"__esModule",{value:!0});const vt=F,Ri={message({keyword:e,schemaCode:t}){const r=e==="maxItems"?"more":"fewer";return(0,vt.str)`must NOT have ${r} than ${t} items`},params:({schemaCode:e})=>(0,vt._)`{limit: ${e}}`},Mi={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Ri,code(e){const{keyword:t,data:r,schemaCode:n}=e,s=t==="maxItems"?vt.operators.GT:vt.operators.LT;e.fail$data((0,vt._)`${r}.length ${s} ${n}`)}};sn.default=Mi;var on={},Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});const xs=Os;xs.code='require("ajv/dist/runtime/equal").default';Rt.default=xs;Object.defineProperty(on,"__esModule",{value:!0});const gr=ne,ie=F,Ci=C,Di=Rt,Ai={message:({params:{i:e,j:t}})=>(0,ie.str)`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>(0,ie._)`{i: ${e}, j: ${t}}`},Vi={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:Ai,code(e){const{gen:t,data:r,$data:n,schema:s,parentSchema:o,schemaCode:i,it:a}=e;if(!n&&!s)return;const c=t.let("valid"),u=o.items?(0,gr.getSchemaTypes)(o.items):[];e.block$data(c,d,(0,ie._)`${i} === false`),e.ok(c);function d(){const m=t.let("i",(0,ie._)`${r}.length`),_=t.let("j");e.setParams({i:m,j:_}),t.assign(c,!0),t.if((0,ie._)`${m} > 1`,()=>(f()?g:y)(m,_))}function f(){return u.length>0&&!u.some(m=>m==="object"||m==="array")}function g(m,_){const $=t.name("item"),h=(0,gr.checkDataTypes)(u,$,a.opts.strictNumbers,gr.DataType.Wrong),w=t.const("indices",(0,ie._)`{}`);t.for((0,ie._)`;${m}--;`,()=>{t.let($,(0,ie._)`${r}[${m}]`),t.if(h,(0,ie._)`continue`),u.length>1&&t.if((0,ie._)`typeof ${$} == "string"`,(0,ie._)`${$} += "_"`),t.if((0,ie._)`typeof ${w}[${$}] == "number"`,()=>{t.assign(_,(0,ie._)`${w}[${$}]`),e.error(),t.assign(c,!1).break()}).code((0,ie._)`${w}[${$}] = ${m}`)})}function y(m,_){const $=(0,Ci.useFunc)(t,Di.default),h=t.name("outer");t.label(h).for((0,ie._)`;${m}--;`,()=>t.for((0,ie._)`${_} = ${m}; ${_}--;`,()=>t.if((0,ie._)`${$}(${r}[${m}], ${r}[${_}])`,()=>{e.error(),t.assign(c,!1).break(h)})))}}};on.default=Vi;var an={};Object.defineProperty(an,"__esModule",{value:!0});const Pr=F,Li=C,qi=Rt,zi={message:"must be equal to constant",params:({schemaCode:e})=>(0,Pr._)`{allowedValue: ${e}}`},Hi={keyword:"const",$data:!0,error:zi,code(e){const{gen:t,data:r,$data:n,schemaCode:s,schema:o}=e;n||o&&typeof o=="object"?e.fail$data((0,Pr._)`!${(0,Li.useFunc)(t,qi.default)}(${r}, ${s})`):e.fail((0,Pr._)`${o} !== ${r}`)}};an.default=Hi;var cn={};Object.defineProperty(cn,"__esModule",{value:!0});const mt=F,Fi=C,Ki=Rt,Ui={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>(0,mt._)`{allowedValues: ${e}}`},xi={keyword:"enum",schemaType:"array",$data:!0,error:Ui,code(e){const{gen:t,data:r,$data:n,schema:s,schemaCode:o,it:i}=e;if(!n&&s.length===0)throw new Error("enum must have non-empty array");const a=s.length>=i.opts.loopEnum;let c;const u=()=>c??(c=(0,Fi.useFunc)(t,Ki.default));let d;if(a||n)d=t.let("valid"),e.block$data(d,f);else{if(!Array.isArray(s))throw new Error("ajv implementation error");const y=t.const("vSchema",o);d=(0,mt.or)(...s.map((m,_)=>g(y,_)))}e.pass(d);function f(){t.assign(d,!1),t.forOf("v",o,y=>t.if((0,mt._)`${u()}(${r}, ${y})`,()=>t.assign(d,!0).break()))}function g(y,m){const _=s[m];return typeof _=="object"&&_!==null?(0,mt._)`${u()}(${r}, ${y}[${m}])`:(0,mt._)`${r} === ${_}`}}};cn.default=xi;Object.defineProperty(Qr,"__esModule",{value:!0});const Ji=Xr,Gi=Yr,Wi=Zr,Bi=tn,Qi=rn,Xi=nn,Yi=sn,Zi=on,ec=an,tc=cn,rc=[Ji.default,Gi.default,Wi.default,Bi.default,Qi.default,Xi.default,Yi.default,Zi.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},ec.default,tc.default];Qr.default=rc;var ln={},ct={};Object.defineProperty(ct,"__esModule",{value:!0});ct.validateAdditionalItems=void 0;const Ke=F,kr=C,nc={message:({params:{len:e}})=>(0,Ke.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,Ke._)`{limit: ${e}}`},sc={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:nc,code(e){const{parentSchema:t,it:r}=e,{items:n}=t;if(!Array.isArray(n)){(0,kr.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}Js(e,n)}};function Js(e,t){const{gen:r,schema:n,data:s,keyword:o,it:i}=e;i.items=!0;const a=r.const("len",(0,Ke._)`${s}.length`);if(n===!1)e.setParams({len:t.length}),e.pass((0,Ke._)`${a} <= ${t.length}`);else if(typeof n=="object"&&!(0,kr.alwaysValidSchema)(i,n)){const u=r.var("valid",(0,Ke._)`${a} <= ${t.length}`);r.if((0,Ke.not)(u),()=>c(u)),e.ok(u)}function c(u){r.forRange("i",t.length,a,d=>{e.subschema({keyword:o,dataProp:d,dataPropType:kr.Type.Num},u),i.allErrors||r.if((0,Ke.not)(u),()=>r.break())})}}ct.validateAdditionalItems=Js;ct.default=sc;var un={},lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.validateTuple=void 0;const Wn=F,xt=C,oc=H,ac={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:r}=e;if(Array.isArray(t))return Gs(e,"additionalItems",t);r.items=!0,!(0,xt.alwaysValidSchema)(r,t)&&e.ok((0,oc.validateArray)(e))}};function Gs(e,t,r=e.schema){const{gen:n,parentSchema:s,data:o,keyword:i,it:a}=e;d(s),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=xt.mergeEvaluated.items(n,r.length,a.items));const c=n.name("valid"),u=n.const("len",(0,Wn._)`${o}.length`);r.forEach((f,g)=>{(0,xt.alwaysValidSchema)(a,f)||(n.if((0,Wn._)`${u} > ${g}`,()=>e.subschema({keyword:i,schemaProp:g,dataProp:g},c)),e.ok(c))});function d(f){const{opts:g,errSchemaPath:y}=a,m=r.length,_=m===f.minItems&&(m===f.maxItems||f[t]===!1);if(g.strictTuples&&!_){const $=`"${i}" is ${m}-tuple, but minItems or maxItems/${t} are not specified or different at path "${y}"`;(0,xt.checkStrictMode)(a,$,g.strictTuples)}}}lt.validateTuple=Gs;lt.default=ac;Object.defineProperty(un,"__esModule",{value:!0});const ic=lt,cc={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,ic.validateTuple)(e,"items")};un.default=cc;var dn={};Object.defineProperty(dn,"__esModule",{value:!0});const Bn=F,lc=C,uc=H,dc=ct,fc={message:({params:{len:e}})=>(0,Bn.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,Bn._)`{limit: ${e}}`},hc={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:fc,code(e){const{schema:t,parentSchema:r,it:n}=e,{prefixItems:s}=r;n.items=!0,!(0,lc.alwaysValidSchema)(n,t)&&(s?(0,dc.validateAdditionalItems)(e,s):e.ok((0,uc.validateArray)(e)))}};dn.default=hc;var fn={};Object.defineProperty(fn,"__esModule",{value:!0});const ge=F,Vt=C,pc={message:({params:{min:e,max:t}})=>t===void 0?(0,ge.str)`must contain at least ${e} valid item(s)`:(0,ge.str)`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>t===void 0?(0,ge._)`{minContains: ${e}}`:(0,ge._)`{minContains: ${e}, maxContains: ${t}}`},mc={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:pc,code(e){const{gen:t,schema:r,parentSchema:n,data:s,it:o}=e;let i,a;const{minContains:c,maxContains:u}=n;o.opts.next?(i=c===void 0?1:c,a=u):i=1;const d=t.const("len",(0,ge._)`${s}.length`);if(e.setParams({min:i,max:a}),a===void 0&&i===0){(0,Vt.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,Vt.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),e.fail();return}if((0,Vt.alwaysValidSchema)(o,r)){let _=(0,ge._)`${d} >= ${i}`;a!==void 0&&(_=(0,ge._)`${_} && ${d} <= ${a}`),e.pass(_);return}o.items=!0;const f=t.name("valid");a===void 0&&i===1?y(f,()=>t.if(f,()=>t.break())):i===0?(t.let(f,!0),a!==void 0&&t.if((0,ge._)`${s}.length > 0`,g)):(t.let(f,!1),g()),e.result(f,()=>e.reset());function g(){const _=t.name("_valid"),$=t.let("count",0);y(_,()=>t.if(_,()=>m($)))}function y(_,$){t.forRange("i",0,d,h=>{e.subschema({keyword:"contains",dataProp:h,dataPropType:Vt.Type.Num,compositeRule:!0},_),$()})}function m(_){t.code((0,ge._)`${_}++`),a===void 0?t.if((0,ge._)`${_} >= ${i}`,()=>t.assign(f,!0).break()):(t.if((0,ge._)`${_} > ${a}`,()=>t.assign(f,!1).break()),i===1?t.assign(f,!0):t.if((0,ge._)`${_} >= ${i}`,()=>t.assign(f,!0)))}}};fn.default=mc;var Ws={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=F,r=C,n=H;e.error={message:({params:{property:c,depsCount:u,deps:d}})=>{const f=u===1?"property":"properties";return(0,t.str)`must have ${f} ${d} when property ${c} is present`},params:({params:{property:c,depsCount:u,deps:d,missingProperty:f}})=>(0,t._)`{property: ${c},
    missingProperty: ${f},
    depsCount: ${u},
    deps: ${d}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(c){const[u,d]=o(c);i(c,u),a(c,d)}};function o({schema:c}){const u={},d={};for(const f in c){if(f==="__proto__")continue;const g=Array.isArray(c[f])?u:d;g[f]=c[f]}return[u,d]}function i(c,u=c.schema){const{gen:d,data:f,it:g}=c;if(Object.keys(u).length===0)return;const y=d.let("missing");for(const m in u){const _=u[m];if(_.length===0)continue;const $=(0,n.propertyInData)(d,f,m,g.opts.ownProperties);c.setParams({property:m,depsCount:_.length,deps:_.join(", ")}),g.allErrors?d.if($,()=>{for(const h of _)(0,n.checkReportMissingProp)(c,h)}):(d.if((0,t._)`${$} && (${(0,n.checkMissingProp)(c,_,y)})`),(0,n.reportMissingProp)(c,y),d.else())}}e.validatePropertyDeps=i;function a(c,u=c.schema){const{gen:d,data:f,keyword:g,it:y}=c,m=d.name("valid");for(const _ in u)(0,r.alwaysValidSchema)(y,u[_])||(d.if((0,n.propertyInData)(d,f,_,y.opts.ownProperties),()=>{const $=c.subschema({keyword:g,schemaProp:_},m);c.mergeValidEvaluated($,m)},()=>d.var(m,!0)),c.ok(m))}e.validateSchemaDeps=a,e.default=s})(Ws);var hn={};Object.defineProperty(hn,"__esModule",{value:!0});const Bs=F,yc=C,gc={message:"property name must be valid",params:({params:e})=>(0,Bs._)`{propertyName: ${e.propertyName}}`},$c={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:gc,code(e){const{gen:t,schema:r,data:n,it:s}=e;if((0,yc.alwaysValidSchema)(s,r))return;const o=t.name("valid");t.forIn("key",n,i=>{e.setParams({propertyName:i}),e.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},o),t.if((0,Bs.not)(o),()=>{e.error(!0),s.allErrors||t.break()})}),e.ok(o)}};hn.default=$c;var ar={};Object.defineProperty(ar,"__esModule",{value:!0});const Lt=H,be=F,_c=je,qt=C,vc={message:"must NOT have additional properties",params:({params:e})=>(0,be._)`{additionalProperty: ${e.additionalProperty}}`},wc={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:vc,code(e){const{gen:t,schema:r,parentSchema:n,data:s,errsCount:o,it:i}=e;if(!o)throw new Error("ajv implementation error");const{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,qt.alwaysValidSchema)(i,r))return;const u=(0,Lt.allSchemaProperties)(n.properties),d=(0,Lt.allSchemaProperties)(n.patternProperties);f(),e.ok((0,be._)`${o} === ${_c.default.errors}`);function f(){t.forIn("key",s,$=>{!u.length&&!d.length?m($):t.if(g($),()=>m($))})}function g($){let h;if(u.length>8){const w=(0,qt.schemaRefOrVal)(i,n.properties,"properties");h=(0,Lt.isOwnProperty)(t,w,$)}else u.length?h=(0,be.or)(...u.map(w=>(0,be._)`${$} === ${w}`)):h=be.nil;return d.length&&(h=(0,be.or)(h,...d.map(w=>(0,be._)`${(0,Lt.usePattern)(e,w)}.test(${$})`))),(0,be.not)(h)}function y($){t.code((0,be._)`delete ${s}[${$}]`)}function m($){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){y($);return}if(r===!1){e.setParams({additionalProperty:$}),e.error(),a||t.break();return}if(typeof r=="object"&&!(0,qt.alwaysValidSchema)(i,r)){const h=t.name("valid");c.removeAdditional==="failing"?(_($,h,!1),t.if((0,be.not)(h),()=>{e.reset(),y($)})):(_($,h),a||t.if((0,be.not)(h),()=>t.break()))}}function _($,h,w){const P={keyword:"additionalProperties",dataProp:$,dataPropType:qt.Type.Str};w===!1&&Object.assign(P,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(P,h)}}};ar.default=wc;var pn={};Object.defineProperty(pn,"__esModule",{value:!0});const bc=rr(),Qn=H,$r=C,Xn=ar,Sc={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:n,data:s,it:o}=e;o.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Xn.default.code(new bc.KeywordCxt(o,Xn.default,"additionalProperties"));const i=(0,Qn.allSchemaProperties)(r);for(const f of i)o.definedProperties.add(f);o.opts.unevaluated&&i.length&&o.props!==!0&&(o.props=$r.mergeEvaluated.props(t,(0,$r.toHash)(i),o.props));const a=i.filter(f=>!(0,$r.alwaysValidSchema)(o,r[f]));if(a.length===0)return;const c=t.name("valid");for(const f of a)u(f)?d(f):(t.if((0,Qn.propertyInData)(t,s,f,o.opts.ownProperties)),d(f),o.allErrors||t.else().var(c,!0),t.endIf()),e.it.definedProperties.add(f),e.ok(c);function u(f){return o.opts.useDefaults&&!o.compositeRule&&r[f].default!==void 0}function d(f){e.subschema({keyword:"properties",schemaProp:f,dataProp:f},c)}}};pn.default=Sc;var mn={};Object.defineProperty(mn,"__esModule",{value:!0});const Yn=H,zt=F,Zn=C,es=C,Ec={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:n,parentSchema:s,it:o}=e,{opts:i}=o,a=(0,Yn.allSchemaProperties)(r),c=a.filter(_=>(0,Zn.alwaysValidSchema)(o,r[_]));if(a.length===0||c.length===a.length&&(!o.opts.unevaluated||o.props===!0))return;const u=i.strictSchema&&!i.allowMatchingProperties&&s.properties,d=t.name("valid");o.props!==!0&&!(o.props instanceof zt.Name)&&(o.props=(0,es.evaluatedPropsToName)(t,o.props));const{props:f}=o;g();function g(){for(const _ of a)u&&y(_),o.allErrors?m(_):(t.var(d,!0),m(_),t.if(d))}function y(_){for(const $ in u)new RegExp(_).test($)&&(0,Zn.checkStrictMode)(o,`property ${$} matches pattern ${_} (use allowMatchingProperties)`)}function m(_){t.forIn("key",n,$=>{t.if((0,zt._)`${(0,Yn.usePattern)(e,_)}.test(${$})`,()=>{const h=c.includes(_);h||e.subschema({keyword:"patternProperties",schemaProp:_,dataProp:$,dataPropType:es.Type.Str},d),o.opts.unevaluated&&f!==!0?t.assign((0,zt._)`${f}[${$}]`,!0):!h&&!o.allErrors&&t.if((0,zt.not)(d),()=>t.break())})})}}};mn.default=Ec;var yn={};Object.defineProperty(yn,"__esModule",{value:!0});const Pc=C,kc={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:n}=e;if((0,Pc.alwaysValidSchema)(n,r)){e.fail();return}const s=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),e.failResult(s,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};yn.default=kc;var gn={};Object.defineProperty(gn,"__esModule",{value:!0});const Nc=H,Oc={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Nc.validateUnion,error:{message:"must match a schema in anyOf"}};gn.default=Oc;var $n={};Object.defineProperty($n,"__esModule",{value:!0});const Jt=F,jc=C,Ic={message:"must match exactly one schema in oneOf",params:({params:e})=>(0,Jt._)`{passingSchemas: ${e.passing}}`},Tc={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:Ic,code(e){const{gen:t,schema:r,parentSchema:n,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;const o=r,i=t.let("valid",!1),a=t.let("passing",null),c=t.name("_valid");e.setParams({passing:a}),t.block(u),e.result(i,()=>e.reset(),()=>e.error(!0));function u(){o.forEach((d,f)=>{let g;(0,jc.alwaysValidSchema)(s,d)?t.var(c,!0):g=e.subschema({keyword:"oneOf",schemaProp:f,compositeRule:!0},c),f>0&&t.if((0,Jt._)`${c} && ${i}`).assign(i,!1).assign(a,(0,Jt._)`[${a}, ${f}]`).else(),t.if(c,()=>{t.assign(i,!0),t.assign(a,f),g&&e.mergeEvaluated(g,Jt.Name)})})}}};$n.default=Tc;var _n={};Object.defineProperty(_n,"__esModule",{value:!0});const Rc=C,Mc={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const s=t.name("valid");r.forEach((o,i)=>{if((0,Rc.alwaysValidSchema)(n,o))return;const a=e.subschema({keyword:"allOf",schemaProp:i},s);e.ok(s),e.mergeEvaluated(a)})}};_n.default=Mc;var vn={};Object.defineProperty(vn,"__esModule",{value:!0});const Zt=F,Qs=C,Cc={message:({params:e})=>(0,Zt.str)`must match "${e.ifClause}" schema`,params:({params:e})=>(0,Zt._)`{failingKeyword: ${e.ifClause}}`},Dc={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:Cc,code(e){const{gen:t,parentSchema:r,it:n}=e;r.then===void 0&&r.else===void 0&&(0,Qs.checkStrictMode)(n,'"if" without "then" and "else" is ignored');const s=ts(n,"then"),o=ts(n,"else");if(!s&&!o)return;const i=t.let("valid",!0),a=t.name("_valid");if(c(),e.reset(),s&&o){const d=t.let("ifClause");e.setParams({ifClause:d}),t.if(a,u("then",d),u("else",d))}else s?t.if(a,u("then")):t.if((0,Zt.not)(a),u("else"));e.pass(i,()=>e.error(!0));function c(){const d=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);e.mergeEvaluated(d)}function u(d,f){return()=>{const g=e.subschema({keyword:d},a);t.assign(i,a),e.mergeValidEvaluated(g,i),f?t.assign(f,(0,Zt._)`${d}`):e.setParams({ifClause:d})}}}};function ts(e,t){const r=e.schema[t];return r!==void 0&&!(0,Qs.alwaysValidSchema)(e,r)}vn.default=Dc;var wn={};Object.defineProperty(wn,"__esModule",{value:!0});const Ac=C,Vc={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){t.if===void 0&&(0,Ac.checkStrictMode)(r,`"${e}" without "if" is ignored`)}};wn.default=Vc;Object.defineProperty(ln,"__esModule",{value:!0});const Lc=ct,qc=un,zc=lt,Hc=dn,Fc=fn,Kc=Ws,Uc=hn,xc=ar,Jc=pn,Gc=mn,Wc=yn,Bc=gn,Qc=$n,Xc=_n,Yc=vn,Zc=wn;function el(e=!1){const t=[Wc.default,Bc.default,Qc.default,Xc.default,Yc.default,Zc.default,Uc.default,xc.default,Kc.default,Jc.default,Gc.default];return e?t.push(qc.default,Hc.default):t.push(Lc.default,zc.default),t.push(Fc.default),t}ln.default=el;var bn={},Sn={};Object.defineProperty(Sn,"__esModule",{value:!0});const te=F,tl={message:({schemaCode:e})=>(0,te.str)`must match format "${e}"`,params:({schemaCode:e})=>(0,te._)`{format: ${e}}`},rl={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:tl,code(e,t){const{gen:r,data:n,$data:s,schema:o,schemaCode:i,it:a}=e,{opts:c,errSchemaPath:u,schemaEnv:d,self:f}=a;if(!c.validateFormats)return;s?g():y();function g(){const m=r.scopeValue("formats",{ref:f.formats,code:c.code.formats}),_=r.const("fDef",(0,te._)`${m}[${i}]`),$=r.let("fType"),h=r.let("format");r.if((0,te._)`typeof ${_} == "object" && !(${_} instanceof RegExp)`,()=>r.assign($,(0,te._)`${_}.type || "string"`).assign(h,(0,te._)`${_}.validate`),()=>r.assign($,(0,te._)`"string"`).assign(h,_)),e.fail$data((0,te.or)(w(),P()));function w(){return c.strictSchema===!1?te.nil:(0,te._)`${i} && !${h}`}function P(){const O=d.$async?(0,te._)`(${_}.async ? await ${h}(${n}) : ${h}(${n}))`:(0,te._)`${h}(${n})`,I=(0,te._)`(typeof ${h} == "function" ? ${O} : ${h}.test(${n}))`;return(0,te._)`${h} && ${h} !== true && ${$} === ${t} && !${I}`}}function y(){const m=f.formats[o];if(!m){w();return}if(m===!0)return;const[_,$,h]=P(m);_===t&&e.pass(O());function w(){if(c.strictSchema===!1){f.logger.warn(I());return}throw new Error(I());function I(){return`unknown format "${o}" ignored in schema at path "${u}"`}}function P(I){const R=I instanceof RegExp?(0,te.regexpCode)(I):c.code.formats?(0,te._)`${c.code.formats}${(0,te.getProperty)(o)}`:void 0,D=r.scopeValue("formats",{key:o,ref:I,code:R});return typeof I=="object"&&!(I instanceof RegExp)?[I.type||"string",I.validate,(0,te._)`${D}.validate`]:["string",I,D]}function O(){if(typeof m=="object"&&!(m instanceof RegExp)&&m.async){if(!d.$async)throw new Error("async format in sync schema");return(0,te._)`await ${h}(${n})`}return typeof $=="function"?(0,te._)`${h}(${n})`:(0,te._)`${h}.test(${n})`}}}};Sn.default=rl;Object.defineProperty(bn,"__esModule",{value:!0});const nl=Sn,sl=[nl.default];bn.default=sl;var st={};Object.defineProperty(st,"__esModule",{value:!0});st.contentVocabulary=st.metadataVocabulary=void 0;st.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];st.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(Gr,"__esModule",{value:!0});const ol=Wr,al=Qr,il=ln,cl=bn,rs=st,ll=[ol.default,al.default,(0,il.default)(),cl.default,rs.metadataVocabulary,rs.contentVocabulary];Gr.default=ll;var En={},ir={};Object.defineProperty(ir,"__esModule",{value:!0});ir.DiscrError=void 0;var ns;(function(e){e.Tag="tag",e.Mapping="mapping"})(ns||(ir.DiscrError=ns={}));Object.defineProperty(En,"__esModule",{value:!0});const Ze=F,Nr=ir,ss=pe,ul=it,dl=C,fl={message:({params:{discrError:e,tagName:t}})=>e===Nr.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>(0,Ze._)`{error: ${e}, tag: ${r}, tagValue: ${t}}`},hl={keyword:"discriminator",type:"object",schemaType:"object",error:fl,code(e){const{gen:t,data:r,schema:n,parentSchema:s,it:o}=e,{oneOf:i}=s;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");const a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");const c=t.let("valid",!1),u=t.const("tag",(0,Ze._)`${r}${(0,Ze.getProperty)(a)}`);t.if((0,Ze._)`typeof ${u} == "string"`,()=>d(),()=>e.error(!1,{discrError:Nr.DiscrError.Tag,tag:u,tagName:a})),e.ok(c);function d(){const y=g();t.if(!1);for(const m in y)t.elseIf((0,Ze._)`${u} === ${m}`),t.assign(c,f(y[m]));t.else(),e.error(!1,{discrError:Nr.DiscrError.Mapping,tag:u,tagName:a}),t.endIf()}function f(y){const m=t.name("valid"),_=e.subschema({keyword:"oneOf",schemaProp:y},m);return e.mergeEvaluated(_,Ze.Name),m}function g(){var y;const m={},_=h(s);let $=!0;for(let O=0;O<i.length;O++){let I=i[O];if(I?.$ref&&!(0,dl.schemaHasRulesButRef)(I,o.self.RULES)){const D=I.$ref;if(I=ss.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,D),I instanceof ss.SchemaEnv&&(I=I.schema),I===void 0)throw new ul.default(o.opts.uriResolver,o.baseId,D)}const R=(y=I?.properties)===null||y===void 0?void 0:y[a];if(typeof R!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);$=$&&(_||h(I)),w(R,O)}if(!$)throw new Error(`discriminator: "${a}" must be required`);return m;function h({required:O}){return Array.isArray(O)&&O.includes(a)}function w(O,I){if(O.const)P(O.const,I);else if(O.enum)for(const R of O.enum)P(R,I);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function P(O,I){if(typeof O!="string"||O in m)throw new Error(`discriminator: "${a}" values must be unique strings`);m[O]=I}}}};En.default=hl;const pl="http://json-schema.org/draft-07/schema#",ml="http://json-schema.org/draft-07/schema#",yl="Core schema meta-schema",gl={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},$l=["object","boolean"],_l={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},vl={$schema:pl,$id:ml,title:yl,definitions:gl,type:$l,properties:_l,default:!0};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=t.Ajv=void 0;const r=ms,n=Gr,s=En,o=vl,i=["/properties"],a="http://json-schema.org/draft-07/schema";class c extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach(m=>this.addVocabulary(m)),this.opts.discriminator&&this.addKeyword(s.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const m=this.opts.$data?this.$dataMetaSchema(o,i):o;this.addMetaSchema(m,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}t.Ajv=c,e.exports=t=c,e.exports.Ajv=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var u=rr();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return u.KeywordCxt}});var d=F;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return d._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return d.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return d.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return d.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return d.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return d.CodeGen}});var f=Tt;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return f.default}});var g=it;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return g.default}})})(vr,vr.exports);const wl=go(vr.exports),bl=0xcbf29ce484222325n,Sl=0x84222325cbf29ce4n,El=0x100000001b3n,Pl=(1n<<64n)-1n,os=(e,t)=>{let r=t;for(let n=0;n<e.length;n+=1)r^=BigInt(e.charCodeAt(n)),r=r*El&Pl;return r},as=e=>e.toString(16).padStart(16,"0"),Pn=(...e)=>{const t=JSON.stringify(e),r=os(t,bl),n=os(t,Sl);return`${as(r)}${as(n)}`},Ve={type:"string"},kl={type:"number"},ot=(e,t={})=>({type:"object",properties:e,required:Object.keys(e),...t}),Nl=e=>({type:"array",items:e}),Le=e=>JSON.stringify(e,null,2),at=e=>JSON.parse(e),Ol=(e,t)=>{const r=new wl().compile(t);if(r(e))return!0;throw new Error(r.errors?.map(n=>n.message).join(", ")||"Invalid data")};function Ee({schemaHash:e,data:t}){if(e==="0"&&Le(t)!="{}")throw new Error("schema hash is 0 but data is not empty :"+Le(t));return Pn(e,t)}function Pe(e,t,r){return{schemaHash:Ee(t),data:{...e?{title:e}:{},...r}}}const We={schemaHash:"0",data:{}},Mt=Pe("script_schema",We,ot({title:Ve,code:Ve})),kn=Pe("script_result_schema",We,ot({title:Ve,script:"#"+Ee(Mt),content:{}},{title:"script_result_schema"})),Xs=Pe("titled_schema",We,ot({title:Ve})),Nn=Pe("has_titled_child",We,ot({child:ot({title:Ve})})),On=Pe("a titled",Xs,{title:"im child"}),jl=Pe("titled1",Nn,{child:On.data}),Il=Pe("titled2",Nn,{child:`#${Ee(On)}`}),cr=Pe("function schema",We,ot({inputs:Nl(Ve),code:Ve},{title:"function_schema"})),Tl=Pe("example function",cr,{title:"example function",inputs:["a","b"],code:"return a + b"});Pe("",We,Ve),Pe("",We,kl);const wt=e=>typeof e=="string"&&/^#([a-f0-9]+)$/.exec(e),bt=async(e,t,r=new Set)=>{if(typeof e=="string"){const n=wt(e);if(!n)return e;const s=n[1];if(r.has(s))throw new Error(`cycle: #${s}`);return r.add(s),bt(await t(s),t,r)}return Array.isArray(e)?Promise.all(e.map(n=>bt(n,t,r))):e&&typeof e=="object"?Object.fromEntries(await Promise.all(Object.entries(e).map(async([n,s])=>[n,await bt(s,t,r)]))):e},Rl=(e,t,r)=>typeof e=="number"?t(e):(e[0]=="#"&&(e=e.slice(1)),e.length==32?r(e):t(Number(e))),Ys="jsonview",Or={local:"http://localhost:3000",prod:"https://maincloud.spacetimedb.com"},Ml=()=>{const e=new URLSearchParams(window.location.search).get("db"),t=localStorage.getItem("db_preset");return e&&Or[e]?(localStorage.setItem("db_preset",e),e):t&&Or[t]?t:"local"},Cl=Ml(),Zs=Or[Cl];let er=localStorage.getItem("access_token");const jn=(e,t,r=null)=>fetch(`${Zs}${e}`,{method:t,headers:{"Content-Type":"application/json",...er?{Authorization:`Bearer ${er}`}:{}},body:r}),ke=async(e,t=!1,r=null)=>{if(t&&r!=null){const s=await ke("select count from note_count");let o=Math.max(0,Number(s.rows[0][0])-r);e=e+` where id > ${o}`}const n=await(await jn(`/v1/database/${Ys}/sql`,"POST",e)).text();try{const s=JSON.parse(n);s.length>1&&console.warn("multiple rows returned, TODO: handle this");const{schema:o,rows:i}=s[0];return{names:o.elements.map(a=>a.name.some),rows:t?i.reverse():i}}catch(s){return xe(ue(n)),{names:["error"],rows:[s.message]}}},eo=e=>{const t=new Map,r=Pn(e.toString()+":cached:"+Zs);return async n=>{const s=r+JSON.stringify(n);if(t.has(s))return t.get(s);const o=localStorage.getItem(s);if(o){const a=JSON.parse(o);return t.set(s,a),a}const i=await e(n);return localStorage.setItem(s,JSON.stringify(i)),t.set(s,i),i}},to=async(e,t)=>{let r=await Nt(e);const n=await jn(`/v1/database/${Ys}/call/add_note`,"POST",JSON.stringify({schemaHash:r,data:Le(t)}));if(!n.ok)throw new Error(await n.text());return"#"+Ee({schemaHash:r,data:t})},lr=eo(async e=>{const t=await ke(Rl(e,n=>`select * from note where id = ${n}`,n=>`select * from note where hash = '${n}'`)),r=t.rows[0];if(!r)throw new Error("note not found");return Object.fromEntries(t.names.map((n,s)=>[n,r[s]]))}),In=e=>lr(e).then(t=>t.id),Nt=e=>lr(e).then(t=>t.hash),ro=e=>lr(e).then(t=>t.schemaId),Oe=eo(async e=>{const t=await lr(e);return{schemaHash:await Nt(t.schemaId),data:at(t.data)}});er===null&&jn("/v1/identity","POST").then(e=>e.json()).then(e=>{er=e.token});const Dl=async e=>{try{const t=s=>Oe(s).then(o=>o.data),r=typeof e.data=="string"?JSON.parse(e.data):e.data,n=(await Oe(e.schemaHash)).data;return Ol(await bt(r,t),await bt(n,t))}catch(t){throw new Error(t.message||t)}},jr=e=>Oe(e).then(async t=>{let r=t.data,n=typeof r=="string"?r:JSON.stringify(r);return n=n.replace(/\n/g," "),`#${await In(e)}`+(r?.title?`:${r.title}`:typeof r=="string"||typeof r=="number"?`:${n.slice(0,20)}`:"")}),no=e=>Oe(e).then(async t=>{let r=t.data,n="",s=(o,i)=>{let a="  ".repeat(i);(typeof o=="string"||typeof o=="number")&&(n+=o),typeof o=="object"&&Object.entries(o).forEach(([c,u])=>{n+=`
`+a+c+":",s(u,i+1)})};return s(r,0),n}),Tn=(e,t,r={})=>{let n=nt(t??`#${e}`);const s=typeof e=="string"?e.replace(/^#/,""):String(e);return t===void 0&&jr(e).then(o=>n.innerHTML=o),Wt(`/${s}`,n,r)},Al=e=>JSON.stringify(e,null,2),Ue=K(ue("loading...")),Rn=(e,t)=>{const r=[...t].sort((i,a)=>(a.count||0)-(i.count||0)||(Number(a.id)||0)-(Number(i.id)||0)),n=i=>{Ue.innerHTML="";const a=K(x({display:"flex",flexDirection:"column",gap:"0.5em"}));i.slice(0,10).forEach(c=>{const u=c.count!==void 0?` (${c.count})`:"",d=K(x({display:"flex",gap:"0.5em",alignItems:"center"}),se(`#${c.id}${c.title?` : ${c.title}`:""}${u}`,{style:{textAlign:"left",width:"100%"},onclick:()=>{e(c),o.remove()}}),se("preview",{onclick:()=>window.open(`/${c.hash}`,"_blank","noopener"),style:{fontSize:"0.85em",padding:"0.2em 0.4em"}}));a.appendChild(d)}),Ue.appendChild(a)};n(r);const s=Pt("",{placeholder:"search id, title, hash"});s.oninput=()=>{const i=s.value.trim().toLowerCase();if(!i)return n(r);const a=r.filter(u=>u.id.toLowerCase().includes(i));if(a.length)return n(a);const c=r.filter(u=>u.title.toLowerCase().includes(i));return n(c)};let o=xe(K(x({display:"flex",flexDirection:"column",gap:"0.5em"}),s,Ue))},so=(e,t,r="change schema")=>se(r,{onclick:()=>{e().then(n=>{Rn(t,n)}).catch(n=>{Ue.innerHTML="",Ue.appendChild(ue(n.message||"failed to load schemas"))})}}),yt=(e,t)=>{let{type:r,properties:n,items:s}=e;if(!r){let i=yt({type:"string"},()=>{try{let u=i.getData(),d=at(u);c.innerHTML="",a.onclick=()=>i.setData(Le(d))}catch(u){c.innerHTML=String(u)}}),a=se("format"),c=nt("hello",x({color:"red",margin:"0.5em"}));return{element:K(i.element,K(a,c)),getData:()=>at(i.getData()),setData:u=>i.setData(Le(u))}}const o=i=>{let a="";const c=nt();c.style.display="none",c.onclick=()=>{a="",c.style.display="none",i.element.style.display="",t()};const u=y=>{a=y,wt(a)?(c.innerText=a,c.style.display="",i.element.style.display="none"):(c.style.display="none",i.element.style.display=""),t()},d=()=>ke("select id, data, hash from note",!0,200).then(y=>y.rows.map(m=>{let _="";try{const $=JSON.parse(String(m[1]??""));_=$?.title?String($.title):""}catch{}return{id:String(m[0]),title:_,hash:String(m[2]??"")}})),g=se("\u{1F517}",{onclick:()=>{d().then(y=>{Rn(m=>u(`#${m.hash}`),y)}).catch(y=>{Ue.innerHTML="",Ue.appendChild(ue(y.message||"failed to load notes"))})},style:{background:"transparent",border:"none",padding:"0 0.1em",cursor:"pointer"}});return{element:K(x({display:"inline-flex",alignItems:"center",gap:"0.25em"}),g,c,i.element),getData:()=>wt(a)?a:i.getData(),setData:y=>{typeof y=="string"&&wt(y)?u(y):(u(""),i.setData(y))}}};if(r=="string"){let i=Mr();i.rows=1,i.style.resize="none",i.style.overflow="hidden",i.style.verticalAlign="middle",i.style.boxSizing="content-box";const a=12,c=()=>{i.style.height="0px",i.style.height=`${i.scrollHeight}px`;const u=i.value.split(`
`).reduce((d,f)=>Math.max(d,f.length),0);i.style.width=`${Math.max(a,u+1)}ch`,t()};return i.oninput=c,requestAnimationFrame(c),o({element:i,getData:()=>i.value,setData:u=>{i.value=u,c()}})}if(r=="number"){let i=Pt();return i.type="number",i.oninput=t,o({element:i,getData:()=>Number(i.value),setData:a=>{i.value=String(a)}})}if(r=="array"){let i=[],a=K();const c=d=>{const f=K(x({display:"flex",alignItems:"center",gap:"0.25em"}),se("-",{onclick:()=>{i=i.filter(g=>g!==d),f.remove(),t()}}),d.element);return f};let u=K(x({paddingLeft:"0.5em"}),a,se("+",{onclick:()=>{let d=yt(s,t);i.push(d),a.append(c(d)),t()}}));return o({element:u,getData:()=>i.map(d=>d.getData()),setData:d=>{i=d.map(f=>{let g=yt(s,t);return g.setData(f),a.append(c(g)),g})}})}if(r=="object"){const i=new Set(e.required||[]);let a=Object.entries(n).map(([c,u])=>({key:c,field:yt(u,t),box:Pt()}));return o({element:K(a.map(({key:c,field:u,box:d})=>(d.type="checkbox",i.has(c)&&(d.checked=!0,d.disabled=!0),d.oninput=()=>t(),d.onchange=()=>{const f=d.checked||i.has(c);u.element.style.display=f?"":"none",t()},i.has(c)||(u.element.style.display="none"),ue(d,c,":",u.element)))),getData:()=>Object.fromEntries(a.filter(({key:c,field:u})=>i.has(c)||u.element.style.display!=="none").map(({key:c,field:u})=>[c,u.getData()])),setData:c=>{a.forEach(({key:u,field:d,box:f})=>{i.has(u)?d.element.style.display="":(f.checked=!1,d.element.style.display="none")}),Object.entries(c).forEach(([u,d])=>{const f=a.find(g=>g.key===u);f&&(f.field.setData(d),i.has(u)||(f.box.checked=!0,f.field.element.style.display=""))})}})}},oo="$"+Pn("openrouter");let Ht=localStorage.getItem(oo)||"";const Vl=async(e,t)=>{Ht===""&&await new Promise((s,o)=>{let i=Pt(),a=xe(ue("Please enter your OpenRouter API key to use the LLM feature"),i);i.addEventListener("keydown",c=>{c.key=="Enter"&&(Ht=i.value,localStorage.setItem(oo,Ht),s(),a.remove())})});const n=await(await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${await Ht}`,"Content-Type":"application/json"},body:JSON.stringify({model:"openai/gpt-4o",messages:[{role:"user",content:e}],response_format:{type:"json_schema",json_schema:{name:"response",schema:t}}})})).json();try{return JSON.parse(n.choices[0].message.content)}catch{return n}},Ir=new Map;let Ll=1;const ql=e=>(...t)=>new Promise((r,n)=>{const s=Ll++;Ir.set(s,{resolve:r,reject:n}),self.postMessage({type:"call",id:s,name:e,args:JSON.stringify(t)})}),Tr=["openrouter","getNote","addNote","callNote"];self.onmessage=async e=>{const t=e.data||{};if(t.type==="response"){const s=Ir.get(Number(t.id));if(!s)return;Ir.delete(Number(t.id)),t.error?s.reject(t.error):s.resolve(t.result);return}if(t.type!=="run")return;const{code:r,input:n}=t;try{const o=await new Function("input",...Tr,`return (async () => {${r}})()`)(n,...Tr.map(ql));self.postMessage({type:"run_result",ok:!0,result:o})}catch(s){self.postMessage({type:"run_result",ok:!1,error:String(s)})}};const zl=async(e,...t)=>{let r=await Oe(e);if(r.schemaHash!=Ee(cr))throw new Error("can only call Function schema notes");let n=r.data;return new Function(...n.inputs,n.code)(...t)},ao={openrouter:async(e,t)=>(wt(t)&&(t=(await Oe(t)).data),Vl(e,t)),getNote:Oe,addNote:to,callNote:zl};for(let e of Tr)if(!Object.keys(ao).includes(e))throw new Error("buildin missing but expected: "+e);const Hl=e=>{const t=nt(),r=/#([a-f0-9]+)/g;let n=0,s;for(;s=r.exec(e);){const o=s.index,i=s[1],a=/^\d+$/.test(i)?Number(i):i;o>n&&t.append(document.createTextNode(e.slice(n,o))),t.append(Tn(a)),n=o+s[0].length}return n<e.length&&t.append(document.createTextNode(e.slice(n))),t},Fl=(e,t)=>{const r=K(x({display:"flex",flexDirection:"column",gap:"0.75em"}));return Oe(e).then(async n=>{const s=await In(e),o=await ro(e),i=n.data?.title??"",a=f=>new Promise(async(g,y)=>{let m=String(f.data?.code||"");console.info({code:m});const _=new Worker(new URL("/dashboard/assets/script_worker.7e1930b5.js",self.location),{type:"module"});_.onmessage=$=>{const h=$.data||{};if(h.type==="call"){Promise.resolve(ao[h.name](...JSON.parse(h.args))).then(w=>{console.log("responding",w),_.postMessage({type:"response",id:h.id,result:w})}).catch(w=>_.postMessage({type:"response",id:h.id,error:String(w)}));return}if(h.type==="run_result")if(_.terminate(),h.ok){if(h.result==null)return;let w={schemaHash:Ee(kn),data:{title:"result",script:`#${e}`,content:h.result}};g(w)}else xe(Et("ERROR"),ue(h.error||"script error"))},_.postMessage({type:"run",code:m,input:{}})}),c=n.schemaHash===Ee(Mt),u=c?String(n.data.code||""):Al(n.data);r.innerHTML="";const d=Rr(`${c?"Script":"Note"} #${s} ${i} `);if(c){const f=se("run",{onclick:()=>{f.innerHTML="running...",a(n).then(g=>t(g))}});d.append(f)}r.append(d,c?"":ue("schema: ",Tn(o)),K(x({fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",overflowX:"auto"}),Hl(u)),K(x({display:"flex",gap:"0.75em",alignItems:"center"}),Wt(`/edit?id=${s}`,"edit"),Wt(`/deps/${e}`,"deps"),se("copy",{onclick:f=>navigator.clipboard.writeText(u).then(()=>f.target.textContent="copied").catch(g=>xe(Et("ERROR"),ue(g.message||"copy failed")))})))}),r},Kl=({query:e,navigate:t,onRow:r})=>{let n=100;const s="any",o=Ee(Mt),i=Ee(kn),a=K(),c=K(x({display:"flex",gap:"0.5em",alignItems:"center",flexWrap:"wrap"}),se("any",{onclick:()=>d(s)}),se("function",{onclick:()=>d(Ee(cr))}),se("script",{onclick:()=>d(o)}),se("script output",{onclick:()=>d(i)}),so(()=>Promise.all([e("select id, data, hash from note where schemaId = 0"),e("select schemaId from note")]).then(([y,m])=>{const _=new Map;return m.rows.forEach($=>{const h=String($[0]);_.set(h,(_.get(h)||0)+1)}),y.rows.map($=>{let h="";try{const P=JSON.parse(String($[1]??""));h=P?.title?String(P.title):""}catch{}const w=String($[0]);return{id:w,title:h,hash:String($[2]??""),count:_.get(w)||0}})}),y=>d(y.hash)));let u=s;const d=y=>{u=y,f()},f=async()=>{let y=50;a.innerHTML="",a.append(ue("running..."));let m=null;try{const w=await e("select count from note_count");n=Math.max(y,Number(w.rows[0][0]))}catch{}if(u!==s&&(/^\d+$/.test(u)?m=Number(u):m=(await e(`select id from note where hash = '${u}'`)).rows[0]?.[0]??null),u!==s&&m===null){a.innerHTML="",a.append(ue("no matches"));return}const _=`id >= ${n-y} and id < ${n}`,h=`select id, data from note where ${m===null?_:`schemaId = ${m} and ${_}`} limit 50`;e(h).then(w=>{a.innerHTML="";const P=K(x({display:"flex",flexDirection:"column",gap:"0.5em"}));[...w.rows].reverse().forEach(I=>{const R={};w.names.forEach((J,G)=>{R[J]=I[G]}),r&&r(R);let D=String(R.data??"");D=D.replace(/[\n\r]/g,""),D=D.length>60?D.substring(0,60)+"...":D,P.append(Tn(R.id))}),a.append(P)})};return{root:K(x({display:"flex",flexDirection:"column",gap:"0.75em"}),Wt("/edit?new=1",{style:{textDecoration:"none",color:"inherit",fontWeight:"bold",border:"1px solid #ccc",borderRadius:"0.25em",padding:"0.25em 0.5em"}},"+ Add Note"),c,a),runQuery:f}},Ul=e=>{let t="";const r=tr({href:"/0",style:{textDecoration:"underline",color:"inherit"}},"view");r.onclick=u=>{if(u.metaKey||u.ctrlKey)return;u.preventDefault();const d=r.getAttribute("href")||"/";history.pushState({},"",d),window.dispatchEvent(new PopStateEvent("popstate"))};const n=hs(),s=()=>Promise.all([ke("select id, data, hash from note where schemaId = 0"),ke("select schemaId from note")]).then(([u,d])=>{const f=new Map;return d.rows.forEach(g=>{const y=String(g[0]);f.set(y,(f.get(y)||0)+1)}),u.rows.map(g=>{let y="";try{const _=JSON.parse(String(g[1]??""));y=_?.title?String(_.title):""}catch{}const m=String(g[0]);return{id:m,title:y,hash:String(g[2]??""),count:f.get(m)||0}})}),o=()=>no(t).then(u=>n.innerHTML=u),i=u=>{u!==t&&(t=u,r.setAttribute("href",`/${u}`),e(u),o())},a=so(s,u=>i(u.hash));return{root:K(x({padding:"1em",marginTop:"0.5em",borderRadius:"1em",border:"1px solid #ccc",background:"var(--background-color)"}),K(x({display:"flex",alignItems:"center",gap:"0.75em",flexWrap:"wrap"}),r,a),K(x({display:"flex",gap:"1em",alignItems:"flex-start"}),K(n))),setSchemaHash:i,getSchemaHash:()=>t}},xl=({submit:e})=>{const t=Mr(x({fontFamily:"monospace",minHeight:"12em",resize:"vertical",background:"inherit",color:"inherit",width:"100%"})),r=Ee(Mt);let n=null,s="";const o=Pt("",{placeholder:"script title",style:{display:"none",marginBottom:"0.5em",fontSize:"1.1em",padding:"0.4em 0.6em",color:"inherit",background:"inherit",border:"none",outline:"none",width:"100%"}}),i=ue(),a=K(x({display:"none",border:"1px solid #ccc",padding:"0.5em",borderRadius:"0.5em",background:"var(--background-color)"}));t.rows=10,t.cols=100;const c=()=>s==r,u=()=>c()?{schemaHash:s,text:Le({title:o.value,code:t.value})}:{schemaHash:s,text:t.value},d=()=>{t.style.height="auto",t.style.height=`${t.scrollHeight}px`},f=(P,O)=>{i.textContent=P,i.style.color=O};f("valid","green"),t.onkeydown=P=>{if(t.dispatchEvent(new Event("input")),(P.metaKey||P.ctrlKey)&&P.key.toLowerCase()==="s"){P.preventDefault(),h.click();return}if(P.key==="Enter"){P.preventDefault();const O=t.selectionStart||0,I=t.selectionEnd||0,R=t.value.slice(0,O),D=t.value.slice(I),J=R.lastIndexOf(`
`)+1,G=R.slice(J),Q=G.match(/^\s*/)?.[0]||"",re=/[\{\[]\s*$/.test(G)?"  ":"",Z=`
${Q}${re}`;t.value=`${R}${Z}${D}`;const X=O+Z.length;t.setSelectionRange(X,X)}else{const O={"{":"}","[":"]","(":")",'"':'"'};if(P.metaKey||P.ctrlKey||P.altKey||!(P.key in O))return;const I=t.selectionStart||0,R=t.selectionEnd||0;if(I===R&&t.value[I]===O[P.key]){P.preventDefault(),t.setSelectionRange(I+1,I+1);return}if(P.key==='"'&&I===R&&t.value[I-1]==="\\")return;P.preventDefault();const D=t.value.slice(0,I),J=t.value.slice(R),G=O[P.key],Q=t.value.slice(I,R);t.value=`${D}${P.key}${Q}${G}${J}`;const re=I+1+Q.length;t.setSelectionRange(re,re)}};const g=()=>n?Promise.resolve(n):ke("select id, data, hash from note limit 200").then(P=>P.rows.map(O=>{const I=String(O[0]);let R="";try{const J=JSON.parse(String(O[1]??""));R=J?.title?String(J.title):""}catch{}const D=String(O[2]??"");return{id:I,title:R,hash:D}})).then(P=>n=P),y=()=>{if(!c()){a.style.display="none";return}const P=t.selectionStart??0,O=t.value,I=O.lastIndexOf("#",P-1);if(I<0){a.style.display="none";return}const R=O.slice(I+1,P);if(!/^[A-Za-z0-9]*$/.test(R)){a.style.display="none";return}g().then(D=>{const J=R.toLowerCase(),G=D.filter(Q=>Q.id.toLowerCase().includes(J)||Q.title.toLowerCase().includes(J)).slice(0,8);if(a.innerHTML="",!G.length){a.style.display="none";return}G.forEach(Q=>{const re=`#${Q.id}${Q.title?`: ${Q.title}`:""}`;a.appendChild(se(re,{onclick:()=>{const Z=O.slice(0,I),X=O.slice(P),ee=`#${Q.id}`;t.value=`${Z}${ee}${X}`;const me=Z.length+ee.length;t.setSelectionRange(me,me),_(t.value),a.style.display="none"}}))}),a.style.display="block"})};t.oninput=()=>{_(t.value),y(),d(),window.location.search.includes("new=1")&&history.replaceState({},"","/edit")};const m=async()=>{i.innerText="validating...",i.style.color="#666";try{const P=JSON.parse(u().text);await Dl({schemaHash:s,data:P}),f("valid","#2a3")}catch(P){f(P.message||"invalid json","#f66")}},_=P=>{t.value!==P&&(t.value=P),m(),localStorage.setItem("edit_draft",JSON.stringify(u()))},$=P=>{const O=t.value;s=P,o.style.display=c()?"block":"none",c()?_(at(O).code??""):_(O)},h=se("format json (cmd+s)",{onclick:()=>{c()||_(Le(at(t.value)))}}),w=K(o,t,a,K(x({display:"flex",gap:"0.5em",alignItems:"center"}),h,i),se("push",{onclick:()=>e({schemaHash:s,data:JSON.parse(u().text)})}));return d(),{root:w,setSchemaHash:$,fill:({schemaHash:P,text:O})=>{_(O),$(P),t.focus()}}},Jl=({submit:e})=>{let t,r,n=K();const s=i=>(t=i,n.innerHTML="",Oe(t).then(a=>{r=yt(a.data,()=>{}),n.innerHTML="",n.append(r.element)})),o=i=>r.setData(at(i));return{setSchemaHash:s,fill:({schemaHash:i,text:a})=>s(i).then(()=>o(a)),root:n}},Gl=e=>{const t=xl(e),r=Jl(e);let n={plain:t,nice:r}[localStorage.editmode||"nice"];const s=Ul(d=>n.setSchemaHash(d)),i=se("niceview",{onclick:()=>{n=n==r?t:r,n.fill(u),localStorage.editmode=n==r?"nice":"plain",c()}}),a=K(),c=()=>{a.innerHTML="",a.append(i,n.root,s.root)};let u;return c(),{fill:d=>{u=d,s.setSchemaHash(d.schemaHash),n.fill(d)},root:a}},Wl=({query:e,onRow:t})=>{const r="dashboard_sql",n=localStorage.getItem(r),s=Mr(x({fontFamily:"monospace",padding:".5em"}),n||"select id, data from note limit 50");s.rows=2,s.cols=100,s.onkeydown=d=>{(d.metaKey||d.ctrlKey)&&d.key==="Enter"&&(d.preventDefault(),a())},s.oninput=()=>{localStorage.setItem(r,s.value)};const o=K(),i=d=>{if(typeof d=="bigint")return d.toString();if(typeof d=="number"){const f=String(d);return f.includes("e")||f.includes("E")?d.toLocaleString("fullwide",{useGrouping:!1}):f}return String(d)},a=()=>{o.innerHTML="",o.append(ue("running...")),e(s.value).then(d=>{o.innerHTML="";const f=po(x({borderCollapse:"collapse"}),An(d.names.map(g=>yo(x({border:"1px solid #ccc",padding:".5em"}),g))),...d.rows.map(g=>{const y={};return d.names.forEach((m,_)=>{y[m]=g[_]}),t&&t(y),An(...g.map(m=>{let _=i(m).replace(/[\n\r]/g,"");return _=_.length>20?_.substring(0,20)+"...":_,mo(x({border:"1px solid #ccc",padding:".5em"}),_)}))}));o.append(f)})},c=K(x({display:"flex",alignItems:"center",gap:"0.5em"}),ue(x({opacity:"0.6",margin:"0"}),"SQL console:"),se("run",{onclick:a,style:{fontSize:"0.85em",padding:"0.2em 0.5em"}}));return{root:K(x({display:"flex",flexDirection:"column",gap:"0.75em"}),Rr("SQL"),c,s,o),runQuery:a}},Ot=(e,t)=>(e.insertAdjacentHTML("beforeend",t),e.lastElementChild),jt=(e,t)=>{if(t.x>1||t.y>1)return t;const{width:r,height:n}=e.getBoundingClientRect();return{x:t.x*r,y:t.y*n}},is=(e,t,r,n={})=>{const{stroke:s="currentColor",strokeWidth:o=2,curvature:i=.4}=n,a=jt(e,t),c=jt(e,r),u=Math.max(10,Math.abs(c.x-a.x)*i);Ot(e,`<path d="M ${a.x} ${a.y} C ${a.x+u} ${a.y} ${c.x-u} ${c.y} ${c.x} ${c.y}" fill="none" stroke="${s}" stroke-width="${o}"></path>`);const d=10,f=c.x-d,g=c.y-d*.5,y=c.x-d,m=c.y+d*.5;return Ot(e,`<path d="M ${c.x} ${c.y} L ${f} ${g} M ${c.x} ${c.y} L ${y} ${m}" fill="none" stroke="${s}" stroke-width="${o}"></path>`)},Bl=(e,t,r,n={})=>{const{stroke:s="currentColor",strokeWidth:o=2}=n,i=jt(e,t),a=jt(e,r);Ot(e,`<path d="M ${i.x} ${i.y} L ${a.x} ${a.y}" fill="none" stroke="${s}" stroke-width="${o}"></path>`);const c=10,u=a.x-c*.5,d=a.y-c,f=a.x+c*.5,g=a.y-c;return Ot(e,`<path d="M ${a.x} ${a.y} L ${u} ${d} M ${a.x} ${a.y} L ${f} ${g}" fill="none" stroke="${s}" stroke-width="${o}"></path>`)},cs=(e,t,r)=>{const s=jt(e,t),o=Ot(e,`<g><text x="${s.x}" y="${s.y}" dominant-baseline="middle" text-anchor="middle" fill="var(--color)" font-size="14" cursor="pointer" font-family="sans-serif">${r}</text></g>`),i=o?.querySelector("text"),a=5,u=i.getBBox().height+a*2,d=s.x-140/2,f=s.y-u/2;return o.insertAdjacentHTML("afterbegin",`<rect x="${d}" y="${f}" width="${140}" height="${u}" rx="2" ry="2" fill="var(--background-color)" cursor="pointer" stroke="var(--color)" stroke-width="2"></rect>`),{node:o,rect:{x:d,y:f,width:140,height:u}}},Ql=(e,t,r=10)=>{const n=[],s=[];e.forEach(i=>{const a=Number(i[0]),c=i[1]||[];c.some(u=>Number(u)===Number(t))&&n.push(a),a===Number(t)&&s.push(...c)});const o=i=>[...new Set(i)];return{currentId:t,inputs:o(n).slice(0,r),outputs:o(s).slice(0,r)}},Xl=({query:e,navigate:t})=>{const r=K(x({display:"flex",flexDirection:"column",gap:"0.75em"})),n=K(x({width:"100%",minHeight:"320px"})),s=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=hs();s.setAttribute("width","100%"),s.setAttribute("height","320"),n.append(s,o);const i=()=>Promise.all([ke("select id, data, hash from note where schemaId = 0"),ke("select schemaId from note")]).then(([c,u])=>{const d=new Map;return u.rows.forEach(f=>{const g=String(f[0]);d.set(g,(d.get(g)||0)+1)}),c.rows.map(f=>{let g="";try{const m=JSON.parse(String(f[1]??""));g=m?.title?String(m.title):""}catch{}const y=String(f[0]);return{id:y,title:g,hash:String(f[2]??""),count:d.get(y)||0}})});r.append(Rr("Dependencies"),n);const a=async c=>{if(s.innerHTML="",!c){i().then(R=>Rn(D=>{window.history.pushState({},"",`/deps/${D.id}`),a(D.id)},R));return}const u=await In(c),d=await ro(c),f=await e("select to, from from links"),g=Ql(f.rows,u);g.inputs=g.inputs.filter(R=>R!=d);const y=[{ids:g.inputs,x:.2},{ids:[g.currentId],x:.5},{ids:g.outputs,x:.8}],m=new Map;await Promise.all(y.flatMap(R=>R.ids.map(async D=>{const J=await jr(D).then(G=>G.slice(0,15)).catch(()=>`#${D}`);m.set(D,J)})));const _=await jr(d).then(R=>R.slice(0,15)).catch(()=>`#${d}`);m.set(d,_);const $=new Map;y.forEach(({ids:R,x:D})=>{const J=Math.max(R.length,1);R.forEach((G,Q)=>{const re=J===1?.5:.2+.6*(Q+.5)/J,Z=cs(s,{x:D,y:re},m.get(G)||`#${G}`);Z.node.onclick=()=>G===g.currentId?t(`/${G}`):a(`#${G}`),$.set(G,Z.rect)})});const h=cs(s,{x:.5,y:.1},m.get(d)||`#${d}`);h.node.onclick=()=>a(`#${d}`);const w=h.rect,P=(R,D)=>({x:D==="left"?R.x:R.x+R.width,y:R.y+R.height/2}),O=(R,D)=>({x:R.x+R.width/2,y:D==="top"?R.y:R.y+R.height}),I=$.get(g.currentId);I&&(g.inputs.forEach(R=>{const D=$.get(R);D&&is(s,P(D,"right"),P(I,"left"))}),g.outputs.forEach(R=>{const D=$.get(R);D&&is(s,P(I,"right"),P(D,"left"))}),w&&Bl(s,O(w,"bottom"),O(I,"top"))),no(g.currentId).then(R=>{o.innerHTML=R})};return{root:r,render:a}};let io=()=>{},Gt=null,St=null,ls=null,ur=()=>{};const co=document.body,et=e=>St&&(St.innerHTML="",St.appendChild(e)),Ct=e=>(history.pushState({},"",e),ur()),lo=async e=>{try{const t=await to(e.schemaHash,e.data),r=typeof t=="string"?t.slice(1):String(await Nt(t));Ct(`/${r}`)}catch(t){xe(Et("ERROR"),ue(t.message||"failed to add note"))}},us=e=>et(Fl(e,lo)),Yl=e=>e?e.startsWith("deps/")?"/deps":`/${e}`:"/";ur=()=>{const e=window.location.pathname.replace(/^\/+/,"");if(console.log(e),uo.forEach(t=>{t.style.setProperty("opacity",t.pathname===Yl(e)?"1":"0.5")}),e==="edit"){et(fo.root);const t=new URLSearchParams(window.location.search),r=t.get("id");if(t.get("new")==="1"&&localStorage.removeItem("edit_draft"),r===null){const s=localStorage.getItem("edit_draft");if(s&&s!==ls){ls=s;try{const o=JSON.parse(s);Gt(o)}catch{}}else Nt(0).then(o=>Gt({schemaHash:o,text:"{}"})).catch(()=>{})}else Oe(Number(r)).then(s=>Gt({schemaHash:s.schemaHash,text:Le(s.data)})).catch(s=>xe(Et("ERROR"),ue(s.message)))}else e?e==="sql"?et(eu.root):e.startsWith("deps")?(et(ds.root),ds.render(e.slice(5)||_r)):Number.isFinite(Number(e))?Nt(Number(e)).then(t=>{_r=String(t),us(t)}):(_r=e,us(e)):(et(Mn.root),io())};const Zl=x({padding:"1.5em",margin:".5em",borderRadius:"1em",background:"var(--background-color)",color:"var(--color)",border:"1px solid #ccc"});let _r=null,uo=[["Dashboard","/"],["Edit","/edit"],["SQL","/sql"],["Deps","/deps"]].map(([e,t])=>tr(x({textDecoration:"none",color:"inherit",fontWeight:"bold"}),{href:t,onclick:r=>{r.metaKey||(r.preventDefault(),Ct(t))}},e));co.appendChild(K(x({display:"flex",flexDirection:"column",gap:"0.75em",padding:"1em"}),tr(x({textDecoration:"none",color:"inherit"}),Et("Json View"),{href:"/",onclick:e=>{e.preventDefault(),Ct("/")}}),K(x({display:"flex",gap:"1em"}),uo)));const Mn=Kl({query:ke,navigate:Ct}),fo=Gl({submit:lo});Gt=fo.fill;const eu=Wl({query:ke}),ds=Xl({query:ke,navigate:Ct});St=K(Zl);co.appendChild(St);io=Mn.runQuery;et(Mn.root);ur();window.addEventListener("popstate",ur);
